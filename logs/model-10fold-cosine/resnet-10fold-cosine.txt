(base) jupyter-st125462@puffer:~/ExtendedUrbansound$ python train_kfold-gpu2.py --model_name alexnet --pretrained --scheduler cosine --batch_size 64 --epochs 5

================================================================================
Training on Fold 1
Train Folds: [2, 3, 4, 5, 6, 7, 8, 9]
Val Fold: [10]
Test Fold: [1]
================================================================================

Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [05:42<00:00,  2.12it/s, loss=0.867, acc=68.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:46<00:00,  1.94it/s]
Epoch 1/5 - Train Loss: 0.8674, Train Acc: 68.80%, Val Loss: 1.0492, Val Acc: 69.49%, Best Val Acc: 69.49% (Epoch 1)
Epoch 2: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [05:32<00:00,  2.19it/s, loss=0.27, acc=91.3]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:46<00:00,  1.92it/s]
Epoch 2/5 - Train Loss: 0.2700, Train Acc: 91.34%, Val Loss: 1.0557, Val Acc: 73.63%, Best Val Acc: 73.63% (Epoch 2)
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [04:26<00:00,  2.72it/s, loss=0.127, acc=96]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:44<00:00,  2.02it/s]
Epoch 3/5 - Train Loss: 0.1266, Train Acc: 96.02%, Val Loss: 1.1380, Val Acc: 79.24%, Best Val Acc: 79.24% (Epoch 3)
Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [05:41<00:00,  2.13it/s, loss=0.0457, acc=98.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:38<00:00,  2.31it/s]
Epoch 4/5 - Train Loss: 0.0457, Train Acc: 98.53%, Val Loss: 1.4690, Val Acc: 78.32%, Best Val Acc: 79.24% (Epoch 3)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [06:05<00:00,  1.98it/s, loss=0.0203, acc=99.3]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:39<00:00,  2.26it/s]
Epoch 5/5 - Train Loss: 0.0203, Train Acc: 99.34%, Val Loss: 1.3244, Val Acc: 80.99%, Best Val Acc: 80.99% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:42<00:00,  2.13it/s]
Traceback (most recent call last):
  File "/home/jupyter-st125462/ExtendedUrbansound/train_kfold-gpu2.py", line 443, in <module>
    main()
  File "/home/jupyter-st125462/ExtendedUrbansound/train_kfold-gpu2.py", line 408, in main
    best_model_path, metrics = train_model(args, fold_split)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter-st125462/ExtendedUrbansound/train_kfold-gpu2.py", line 338, in train_model
    grad_cam_dir = plot_grad_cam_samples(
                   ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter-st125462/ExtendedUrbansound/utils/visualization.py", line 244, in plot_grad_cam_samples
    grayscale_cam = cam(input_tensor=input_tensor, targets=cam_targets)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter-st125462/.local/lib/python3.12/site-packages/pytorch_grad_cam/base_cam.py", line 186, in __call__
    return self.forward(input_tensor, targets, eigen_smooth)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter-st125462/.local/lib/python3.12/site-packages/pytorch_grad_cam/base_cam.py", line 110, in forward
    cam_per_layer = self.compute_cam_per_layer(input_tensor, targets, eigen_smooth)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter-st125462/.local/lib/python3.12/site-packages/pytorch_grad_cam/base_cam.py", line 141, in compute_cam_per_layer
    cam = self.get_cam_image(input_tensor, target_layer, targets, layer_activations, layer_grads, eigen_smooth)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter-st125462/.local/lib/python3.12/site-packages/pytorch_grad_cam/base_cam.py", line 66, in get_cam_image
    weights = self.get_cam_weights(input_tensor, target_layer, targets, activations, grads)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/jupyter-st125462/.local/lib/python3.12/site-packages/pytorch_grad_cam/grad_cam.py", line 31, in get_cam_weights
    raise ValueError("Invalid grads shape." 
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: Invalid grads shape.Shape of grads should be 4 (2D image) or 5 (3D image).
(base) jupyter-st125462@puffer:~/ExtendedUrbansound$ python train_kfold-gpu2.py --model_name resnet18 --pretrained --scheduler cosine --batch_size 64 --epochs 5

================================================================================
Training on Fold 1
Train Folds: [2, 3, 4, 5, 6, 7, 8, 9]
Val Fold: [10]
Test Fold: [1]
================================================================================

Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [02:19<00:00,  5.20it/s, loss=0.193, acc=93.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:21<00:00,  4.10it/s]
Epoch 1/5 - Train Loss: 0.1928, Train Acc: 93.90%, Val Loss: 0.8936, Val Acc: 77.88%, Best Val Acc: 77.88% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [03:07<00:00,  3.88it/s, loss=0.0484, acc=98.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:20<00:00,  4.46it/s]
Epoch 2/5 - Train Loss: 0.0484, Train Acc: 98.50%, Val Loss: 0.6770, Val Acc: 83.07%, Best Val Acc: 83.07% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [02:54<00:00,  4.17it/s, loss=0.016, acc=99.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:21<00:00,  4.14it/s]
Epoch 3/5 - Train Loss: 0.0160, Train Acc: 99.54%, Val Loss: 0.5358, Val Acc: 87.24%, Best Val Acc: 87.24% (Epoch 3)
Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [02:34<00:00,  4.69it/s, loss=0.0089, acc=99.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:18<00:00,  4.96it/s]
Epoch 4/5 - Train Loss: 0.0089, Train Acc: 99.71%, Val Loss: 0.5991, Val Acc: 85.40%, Best Val Acc: 87.24% (Epoch 3)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [02:33<00:00,  4.74it/s, loss=0.000929, acc=100]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:19<00:00,  4.73it/s]
Epoch 5/5 - Train Loss: 0.0009, Train Acc: 99.98%, Val Loss: 0.5307, Val Acc: 85.87%, Best Val Acc: 87.24% (Epoch 3)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:18<00:00,  4.82it/s]

Fold 1 Evaluation:
Test Loss: 1.0658, Test Accuracy: 76.98%

================================================================================
Training on Fold 2
Train Folds: [3, 4, 5, 6, 7, 8, 9, 10]
Val Fold: [1]
Test Fold: [2]
================================================================================

Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [02:32<00:00,  4.75it/s, loss=0.191, acc=93.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:19<00:00,  4.66it/s]
Epoch 1/5 - Train Loss: 0.1905, Train Acc: 93.88%, Val Loss: 0.7430, Val Acc: 84.29%, Best Val Acc: 84.29% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [02:38<00:00,  4.57it/s, loss=0.0399, acc=98.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:22<00:00,  4.02it/s]
Epoch 2/5 - Train Loss: 0.0399, Train Acc: 98.76%, Val Loss: 0.9053, Val Acc: 79.12%, Best Val Acc: 84.29% (Epoch 1)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [02:49<00:00,  4.28it/s, loss=0.0127, acc=99.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:21<00:00,  4.28it/s]
Epoch 3/5 - Train Loss: 0.0127, Train Acc: 99.64%, Val Loss: 0.6382, Val Acc: 87.98%, Best Val Acc: 87.98% (Epoch 3)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [02:53<00:00,  4.18it/s, loss=0.00297, acc=99.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:24<00:00,  3.69it/s]
Epoch 4/5 - Train Loss: 0.0030, Train Acc: 99.91%, Val Loss: 0.5711, Val Acc: 83.98%, Best Val Acc: 87.98% (Epoch 3)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [02:56<00:00,  4.09it/s, loss=0.000559, acc=100]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:22<00:00,  4.12it/s]
Epoch 5/5 - Train Loss: 0.0006, Train Acc: 99.99%, Val Loss: 0.5804, Val Acc: 83.96%, Best Val Acc: 87.98% (Epoch 3)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:22<00:00,  4.12it/s]

Fold 2 Evaluation:
Test Loss: 0.9255, Test Accuracy: 83.92%

================================================================================
Training on Fold 3
Train Folds: [1, 4, 5, 6, 7, 8, 9, 10]
Val Fold: [2]
Test Fold: [3]
================================================================================

Epoch 1: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [02:36<00:00,  4.62it/s, loss=0.19, acc=94.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.34it/s]
Epoch 1/5 - Train Loss: 0.1905, Train Acc: 94.06%, Val Loss: 1.0295, Val Acc: 78.48%, Best Val Acc: 78.48% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:35<00:00,  7.56it/s, loss=0.0429, acc=98.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.34it/s]
Epoch 2/5 - Train Loss: 0.0429, Train Acc: 98.62%, Val Loss: 0.7750, Val Acc: 84.40%, Best Val Acc: 84.40% (Epoch 2)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:35<00:00,  7.61it/s, loss=0.0122, acc=99.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.38it/s]
Epoch 3/5 - Train Loss: 0.0122, Train Acc: 99.63%, Val Loss: 1.4087, Val Acc: 77.17%, Best Val Acc: 84.40% (Epoch 2)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:35<00:00,  7.57it/s, loss=0.00409, acc=99.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.19it/s]
Epoch 4/5 - Train Loss: 0.0041, Train Acc: 99.87%, Val Loss: 0.9387, Val Acc: 82.35%, Best Val Acc: 84.40% (Epoch 2)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:35<00:00,  7.58it/s, loss=0.00108, acc=100]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.36it/s]
Epoch 5/5 - Train Loss: 0.0011, Train Acc: 99.98%, Val Loss: 0.9110, Val Acc: 81.51%, Best Val Acc: 84.40% (Epoch 2)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.27it/s]

Fold 3 Evaluation:
Test Loss: 0.9974, Test Accuracy: 79.71%

================================================================================
Training on Fold 4
Train Folds: [1, 2, 5, 6, 7, 8, 9, 10]
Val Fold: [3]
Test Fold: [4]
================================================================================

Epoch 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:34<00:00,  7.63it/s, loss=0.191, acc=94]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.49it/s]
Epoch 1/5 - Train Loss: 0.1913, Train Acc: 93.97%, Val Loss: 0.9715, Val Acc: 77.47%, Best Val Acc: 77.47% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:35<00:00,  7.58it/s, loss=0.0409, acc=98.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.43it/s]
Epoch 2/5 - Train Loss: 0.0409, Train Acc: 98.74%, Val Loss: 1.3399, Val Acc: 77.56%, Best Val Acc: 77.56% (Epoch 2)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:34<00:00,  7.69it/s, loss=0.0143, acc=99.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.58it/s]
Epoch 3/5 - Train Loss: 0.0143, Train Acc: 99.58%, Val Loss: 1.0508, Val Acc: 80.86%, Best Val Acc: 80.86% (Epoch 3)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:34<00:00,  7.61it/s, loss=0.00348, acc=99.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.44it/s]
Epoch 4/5 - Train Loss: 0.0035, Train Acc: 99.89%, Val Loss: 1.0313, Val Acc: 81.41%, Best Val Acc: 81.41% (Epoch 4)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:33<00:00,  7.69it/s, loss=0.000828, acc=100]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.38it/s]
Epoch 5/5 - Train Loss: 0.0008, Train Acc: 99.98%, Val Loss: 1.0103, Val Acc: 82.37%, Best Val Acc: 82.37% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.46it/s]

Fold 4 Evaluation:
Test Loss: 0.8140, Test Accuracy: 84.12%

================================================================================
Training on Fold 5
Train Folds: [1, 2, 3, 6, 7, 8, 9, 10]
Val Fold: [4]
Test Fold: [5]
================================================================================

Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:34<00:00,  7.61it/s, loss=0.183, acc=94.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.51it/s]
Epoch 1/5 - Train Loss: 0.1831, Train Acc: 94.10%, Val Loss: 1.4003, Val Acc: 74.73%, Best Val Acc: 74.73% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:34<00:00,  7.61it/s, loss=0.0454, acc=98.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.66it/s]
Epoch 2/5 - Train Loss: 0.0454, Train Acc: 98.64%, Val Loss: 1.0503, Val Acc: 77.00%, Best Val Acc: 77.00% (Epoch 2)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:35<00:00,  7.60it/s, loss=0.0147, acc=99.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:11<00:00,  7.69it/s]
Epoch 3/5 - Train Loss: 0.0147, Train Acc: 99.54%, Val Loss: 1.0355, Val Acc: 81.06%, Best Val Acc: 81.06% (Epoch 3)
Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:34<00:00,  7.65it/s, loss=0.00188, acc=100]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.46it/s]
Epoch 4/5 - Train Loss: 0.0019, Train Acc: 99.96%, Val Loss: 1.0592, Val Acc: 78.94%, Best Val Acc: 81.06% (Epoch 3)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:33<00:00,  7.69it/s, loss=0.000721, acc=100]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.34it/s]
Epoch 5/5 - Train Loss: 0.0007, Train Acc: 99.98%, Val Loss: 0.9273, Val Acc: 80.66%, Best Val Acc: 81.06% (Epoch 3)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.50it/s]

Fold 5 Evaluation:
Test Loss: 1.0687, Test Accuracy: 78.73%

================================================================================
Training on Fold 6
Train Folds: [1, 2, 3, 4, 7, 8, 9, 10]
Val Fold: [5]
Test Fold: [6]
================================================================================

Epoch 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:37<00:00,  7.44it/s, loss=0.188, acc=94]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.32it/s]
Epoch 1/5 - Train Loss: 0.1878, Train Acc: 94.02%, Val Loss: 1.5297, Val Acc: 74.73%, Best Val Acc: 74.73% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:38<00:00,  7.34it/s, loss=0.0436, acc=98.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.40it/s]
Epoch 2/5 - Train Loss: 0.0436, Train Acc: 98.65%, Val Loss: 1.2528, Val Acc: 72.46%, Best Val Acc: 74.73% (Epoch 1)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:36<00:00,  7.52it/s, loss=0.0138, acc=99.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.43it/s]
Epoch 3/5 - Train Loss: 0.0138, Train Acc: 99.57%, Val Loss: 1.2043, Val Acc: 79.84%, Best Val Acc: 79.84% (Epoch 3)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:35<00:00,  7.59it/s, loss=0.00277, acc=99.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.38it/s]
Epoch 4/5 - Train Loss: 0.0028, Train Acc: 99.94%, Val Loss: 1.2312, Val Acc: 79.14%, Best Val Acc: 79.84% (Epoch 3)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:36<00:00,  7.48it/s, loss=0.000932, acc=100]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.23it/s]
Epoch 5/5 - Train Loss: 0.0009, Train Acc: 99.97%, Val Loss: 1.2165, Val Acc: 80.90%, Best Val Acc: 80.90% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.13it/s]

Fold 6 Evaluation:
Test Loss: 1.1162, Test Accuracy: 80.52%

================================================================================
Training on Fold 7
Train Folds: [1, 2, 3, 4, 5, 8, 9, 10]
Val Fold: [6]
Test Fold: [7]
================================================================================

Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:35<00:00,  7.59it/s, loss=0.181, acc=94.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.31it/s]
Epoch 1/5 - Train Loss: 0.1807, Train Acc: 94.18%, Val Loss: 1.1114, Val Acc: 71.36%, Best Val Acc: 71.36% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:35<00:00,  7.55it/s, loss=0.0362, acc=98.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.28it/s]
Epoch 2/5 - Train Loss: 0.0362, Train Acc: 98.87%, Val Loss: 0.8805, Val Acc: 80.88%, Best Val Acc: 80.88% (Epoch 2)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:36<00:00,  7.48it/s, loss=0.0172, acc=99.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.39it/s]
Epoch 3/5 - Train Loss: 0.0172, Train Acc: 99.46%, Val Loss: 0.9467, Val Acc: 80.21%, Best Val Acc: 80.88% (Epoch 2)
Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:36<00:00,  7.51it/s, loss=0.0038, acc=99.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.28it/s]
Epoch 4/5 - Train Loss: 0.0038, Train Acc: 99.89%, Val Loss: 0.6483, Val Acc: 85.04%, Best Val Acc: 85.04% (Epoch 4)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:35<00:00,  7.59it/s, loss=0.000698, acc=100]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.33it/s]
Epoch 5/5 - Train Loss: 0.0007, Train Acc: 99.99%, Val Loss: 0.5906, Val Acc: 85.57%, Best Val Acc: 85.57% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.14it/s]

Fold 7 Evaluation:
Test Loss: 0.7056, Test Accuracy: 85.61%

================================================================================
Training on Fold 8
Train Folds: [1, 2, 3, 4, 5, 6, 9, 10]
Val Fold: [7]
Test Fold: [8]
================================================================================

Epoch 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:37<00:00,  7.43it/s, loss=0.189, acc=94]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.36it/s]
Epoch 1/5 - Train Loss: 0.1894, Train Acc: 93.97%, Val Loss: 0.8895, Val Acc: 84.22%, Best Val Acc: 84.22% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:52<00:00,  6.46it/s, loss=0.0398, acc=98.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.81it/s]
Epoch 2/5 - Train Loss: 0.0398, Train Acc: 98.80%, Val Loss: 0.8489, Val Acc: 79.14%, Best Val Acc: 84.22% (Epoch 1)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:55<00:00,  6.27it/s, loss=0.014, acc=99.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.62it/s]
Epoch 3/5 - Train Loss: 0.0140, Train Acc: 99.56%, Val Loss: 0.9575, Val Acc: 82.86%, Best Val Acc: 84.22% (Epoch 1)
Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:54<00:00,  6.31it/s, loss=0.0027, acc=99.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.87it/s]
Epoch 4/5 - Train Loss: 0.0027, Train Acc: 99.94%, Val Loss: 0.6874, Val Acc: 87.51%, Best Val Acc: 87.51% (Epoch 4)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:56<00:00,  6.22it/s, loss=0.000607, acc=100]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.83it/s]
Epoch 5/5 - Train Loss: 0.0006, Train Acc: 99.99%, Val Loss: 0.8242, Val Acc: 86.72%, Best Val Acc: 87.51% (Epoch 4)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:13<00:00,  6.71it/s]

Fold 8 Evaluation:
Test Loss: 0.9698, Test Accuracy: 81.39%

================================================================================
Training on Fold 9
Train Folds: [1, 2, 3, 4, 5, 6, 7, 10]
Val Fold: [8]
Test Fold: [9]
================================================================================

Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:56<00:00,  6.23it/s, loss=0.181, acc=94.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.08it/s]
Epoch 1/5 - Train Loss: 0.1809, Train Acc: 94.20%, Val Loss: 1.1505, Val Acc: 80.46%, Best Val Acc: 80.46% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:41<00:00,  7.19it/s, loss=0.0419, acc=98.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.16it/s]
Epoch 2/5 - Train Loss: 0.0419, Train Acc: 98.69%, Val Loss: 0.9633, Val Acc: 77.79%, Best Val Acc: 80.46% (Epoch 1)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:39<00:00,  7.28it/s, loss=0.0166, acc=99.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.25it/s]
Epoch 3/5 - Train Loss: 0.0166, Train Acc: 99.50%, Val Loss: 1.1859, Val Acc: 78.62%, Best Val Acc: 80.46% (Epoch 1)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:39<00:00,  7.30it/s, loss=0.00322, acc=99.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.11it/s]
Epoch 4/5 - Train Loss: 0.0032, Train Acc: 99.93%, Val Loss: 1.0055, Val Acc: 82.54%, Best Val Acc: 82.54% (Epoch 4)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:44<00:00,  6.95it/s, loss=0.000854, acc=100]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:13<00:00,  6.80it/s]
Epoch 5/5 - Train Loss: 0.0009, Train Acc: 99.98%, Val Loss: 0.9619, Val Acc: 82.88%, Best Val Acc: 82.88% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:13<00:00,  6.72it/s]

Fold 9 Evaluation:
Test Loss: 0.6049, Test Accuracy: 90.29%

================================================================================
Training on Fold 10
Train Folds: [1, 2, 3, 4, 5, 6, 7, 8]
Val Fold: [9]
Test Fold: [10]
================================================================================

Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:56<00:00,  6.25it/s, loss=0.193, acc=93.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  6.89it/s]
Epoch 1/5 - Train Loss: 0.1927, Train Acc: 93.78%, Val Loss: 0.8185, Val Acc: 81.02%, Best Val Acc: 81.02% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:55<00:00,  6.29it/s, loss=0.0458, acc=98.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:13<00:00,  6.36it/s]
Epoch 2/5 - Train Loss: 0.0458, Train Acc: 98.51%, Val Loss: 0.8647, Val Acc: 86.74%, Best Val Acc: 86.74% (Epoch 2)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:54<00:00,  6.36it/s, loss=0.0101, acc=99.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:14<00:00,  6.31it/s]
Epoch 3/5 - Train Loss: 0.0101, Train Acc: 99.70%, Val Loss: 0.5824, Val Acc: 90.25%, Best Val Acc: 90.25% (Epoch 3)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:51<00:00,  6.54it/s, loss=0.00338, acc=99.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:13<00:00,  6.60it/s]
Epoch 4/5 - Train Loss: 0.0034, Train Acc: 99.91%, Val Loss: 0.5520, Val Acc: 88.97%, Best Val Acc: 90.25% (Epoch 3)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:53<00:00,  6.40it/s, loss=0.000459, acc=100]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.03it/s]
Epoch 5/5 - Train Loss: 0.0005, Train Acc: 99.99%, Val Loss: 0.4799, Val Acc: 89.76%, Best Val Acc: 90.25% (Epoch 3)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:13<00:00,  6.92it/s]

Fold 10 Evaluation:
Test Loss: 0.7109, Test Accuracy: 83.62%

================================================================================
Summary of results for resnet18
================================================================================
Average Test Accuracy: 82.49%
Individual Fold Test Accuracies: [76.98152305301329, 83.91873278236915, 79.70790378006873, 84.12046543463381, 78.7321063394683, 80.52170928436588, 85.61236623067776, 81.3924721682276, 90.28972783143108, 83.61601678615142]
Summary saved to output/resnet18/summary.json
Total execution time: 6993.09 seconds (1.94 hours)