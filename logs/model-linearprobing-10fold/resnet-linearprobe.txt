(base) jupyter-st125462@puffer:~/ExtendedUrbansound$ python train_kfold.py --model_name resnet18 --pretrained --freeze_features --batch_size 64 --epochs 5

================================================================================
Training on Fold 1
Train Folds: [2, 3, 4, 5, 6, 7, 8, 9]
Val Fold: [10]
Test Fold: [1]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:33<00:00,  7.77it/s, loss=0.978, acc=71.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.29it/s]
Epoch 1/5 - Train Loss: 0.9779, Train Acc: 71.08%, Val Loss: 0.9307, Val Acc: 68.68%, Best Val Acc: 68.68% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:30<00:00,  8.00it/s, loss=0.587, acc=81.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.25it/s]
Epoch 2/5 - Train Loss: 0.5875, Train Acc: 81.74%, Val Loss: 0.8709, Val Acc: 70.36%, Best Val Acc: 70.36% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:29<00:00,  8.07it/s, loss=0.505, acc=84.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:11<00:00,  7.57it/s]
Epoch 3/5 - Train Loss: 0.5051, Train Acc: 84.05%, Val Loss: 0.9003, Val Acc: 70.12%, Best Val Acc: 70.36% (Epoch 2)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:29<00:00,  8.09it/s, loss=0.457, acc=85.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.18it/s]
Epoch 4/5 - Train Loss: 0.4565, Train Acc: 85.47%, Val Loss: 0.8758, Val Acc: 73.25%, Best Val Acc: 73.25% (Epoch 4)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:30<00:00,  8.02it/s, loss=0.428, acc=86.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.33it/s]
Epoch 5/5 - Train Loss: 0.4283, Train Acc: 86.37%, Val Loss: 0.9127, Val Acc: 71.76%, Best Val Acc: 73.25% (Epoch 4)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.38it/s]
Skipping GradCAM visualization for frozen models

Fold 1 Evaluation:
Test Loss: 0.8251, Test Accuracy: 70.04%

================================================================================
Training on Fold 2
Train Folds: [3, 4, 5, 6, 7, 8, 9, 10]
Val Fold: [1]
Test Fold: [2]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:29<00:00,  8.05it/s, loss=0.996, acc=70.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.49it/s]
Epoch 1/5 - Train Loss: 0.9957, Train Acc: 70.45%, Val Loss: 0.8624, Val Acc: 70.76%, Best Val Acc: 70.76% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:30<00:00,  8.03it/s, loss=0.601, acc=81.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:11<00:00,  7.59it/s]
Epoch 2/5 - Train Loss: 0.6010, Train Acc: 81.56%, Val Loss: 0.8174, Val Acc: 73.20%, Best Val Acc: 73.20% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:30<00:00,  7.96it/s, loss=0.514, acc=83.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.23it/s]
Epoch 3/5 - Train Loss: 0.5140, Train Acc: 83.83%, Val Loss: 0.8059, Val Acc: 72.15%, Best Val Acc: 73.20% (Epoch 2)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:30<00:00,  8.00it/s, loss=0.465, acc=85.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.34it/s]
Epoch 4/5 - Train Loss: 0.4647, Train Acc: 85.17%, Val Loss: 0.8079, Val Acc: 72.56%, Best Val Acc: 73.20% (Epoch 2)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:29<00:00,  8.05it/s, loss=0.433, acc=86.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.58it/s]
Epoch 5/5 - Train Loss: 0.4330, Train Acc: 86.11%, Val Loss: 0.8128, Val Acc: 72.60%, Best Val Acc: 73.20% (Epoch 2)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.54it/s]
Skipping GradCAM visualization for frozen models

Fold 2 Evaluation:
Test Loss: 0.8212, Test Accuracy: 71.11%

================================================================================
Training on Fold 3
Train Folds: [1, 4, 5, 6, 7, 8, 9, 10]
Val Fold: [2]
Test Fold: [3]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:30<00:00,  8.01it/s, loss=0.98, acc=71.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.54it/s]
Epoch 1/5 - Train Loss: 0.9796, Train Acc: 71.08%, Val Loss: 0.8717, Val Acc: 70.32%, Best Val Acc: 70.32% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:29<00:00,  8.05it/s, loss=0.589, acc=81.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.27it/s]
Epoch 2/5 - Train Loss: 0.5886, Train Acc: 81.80%, Val Loss: 0.8537, Val Acc: 71.01%, Best Val Acc: 71.01% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:30<00:00,  8.01it/s, loss=0.505, acc=84.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.58it/s]
Epoch 3/5 - Train Loss: 0.5053, Train Acc: 84.20%, Val Loss: 0.8270, Val Acc: 73.98%, Best Val Acc: 73.98% (Epoch 3)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:29<00:00,  8.07it/s, loss=0.457, acc=85.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.45it/s]
Epoch 4/5 - Train Loss: 0.4567, Train Acc: 85.56%, Val Loss: 0.8521, Val Acc: 72.71%, Best Val Acc: 73.98% (Epoch 3)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:30<00:00,  8.04it/s, loss=0.424, acc=86.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.35it/s]
Epoch 5/5 - Train Loss: 0.4236, Train Acc: 86.53%, Val Loss: 0.8859, Val Acc: 72.62%, Best Val Acc: 73.98% (Epoch 3)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.29it/s]
Skipping GradCAM visualization for frozen models

Fold 3 Evaluation:
Test Loss: 0.8674, Test Accuracy: 69.86%

================================================================================
Training on Fold 4
Train Folds: [1, 2, 5, 6, 7, 8, 9, 10]
Val Fold: [3]
Test Fold: [4]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:29<00:00,  8.10it/s, loss=0.974, acc=71.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.37it/s]
Epoch 1/5 - Train Loss: 0.9740, Train Acc: 71.21%, Val Loss: 0.9605, Val Acc: 68.42%, Best Val Acc: 68.42% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:30<00:00,  7.99it/s, loss=0.586, acc=81.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.31it/s]
Epoch 2/5 - Train Loss: 0.5855, Train Acc: 81.94%, Val Loss: 0.9077, Val Acc: 71.72%, Best Val Acc: 71.72% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:29<00:00,  8.05it/s, loss=0.499, acc=84.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.33it/s]
Epoch 3/5 - Train Loss: 0.4994, Train Acc: 84.22%, Val Loss: 0.8866, Val Acc: 71.29%, Best Val Acc: 71.72% (Epoch 2)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:31<00:00,  7.94it/s, loss=0.451, acc=85.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.21it/s]
Epoch 4/5 - Train Loss: 0.4511, Train Acc: 85.75%, Val Loss: 0.9412, Val Acc: 69.90%, Best Val Acc: 71.72% (Epoch 2)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:29<00:00,  8.05it/s, loss=0.422, acc=86.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.43it/s]
Epoch 5/5 - Train Loss: 0.4222, Train Acc: 86.38%, Val Loss: 0.9061, Val Acc: 70.69%, Best Val Acc: 71.72% (Epoch 2)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.37it/s]
Skipping GradCAM visualization for frozen models

Fold 4 Evaluation:
Test Loss: 0.8677, Test Accuracy: 70.26%

================================================================================
Training on Fold 5
Train Folds: [1, 2, 3, 6, 7, 8, 9, 10]
Val Fold: [4]
Test Fold: [5]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:30<00:00,  7.96it/s, loss=0.95, acc=72.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.24it/s]
Epoch 1/5 - Train Loss: 0.9505, Train Acc: 72.08%, Val Loss: 0.8913, Val Acc: 68.14%, Best Val Acc: 68.14% (Epoch 1)
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:29<00:00,  8.07it/s, loss=0.582, acc=82]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.45it/s]
Epoch 2/5 - Train Loss: 0.5817, Train Acc: 82.02%, Val Loss: 0.8407, Val Acc: 70.16%, Best Val Acc: 70.16% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:30<00:00,  7.95it/s, loss=0.494, acc=84.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.38it/s]
Epoch 3/5 - Train Loss: 0.4941, Train Acc: 84.60%, Val Loss: 0.8165, Val Acc: 71.10%, Best Val Acc: 71.10% (Epoch 3)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:29<00:00,  8.04it/s, loss=0.452, acc=85.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.44it/s]
Epoch 4/5 - Train Loss: 0.4516, Train Acc: 85.51%, Val Loss: 0.8062, Val Acc: 71.54%, Best Val Acc: 71.54% (Epoch 4)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:29<00:00,  8.02it/s, loss=0.419, acc=86.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.45it/s]
Epoch 5/5 - Train Loss: 0.4187, Train Acc: 86.61%, Val Loss: 0.7818, Val Acc: 71.83%, Best Val Acc: 71.83% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.34it/s]
Skipping GradCAM visualization for frozen models

Fold 5 Evaluation:
Test Loss: 1.1135, Test Accuracy: 72.21%

================================================================================
Training on Fold 6
Train Folds: [1, 2, 3, 4, 7, 8, 9, 10]
Val Fold: [5]
Test Fold: [6]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:31<00:00,  7.93it/s, loss=0.946, acc=72.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.42it/s]
Epoch 1/5 - Train Loss: 0.9461, Train Acc: 72.06%, Val Loss: 1.1153, Val Acc: 67.72%, Best Val Acc: 67.72% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:31<00:00,  7.90it/s, loss=0.565, acc=82.3]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.10it/s]
Epoch 2/5 - Train Loss: 0.5655, Train Acc: 82.34%, Val Loss: 1.1148, Val Acc: 69.72%, Best Val Acc: 69.72% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:31<00:00,  7.92it/s, loss=0.484, acc=84.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.53it/s]
Epoch 3/5 - Train Loss: 0.4835, Train Acc: 84.85%, Val Loss: 1.1703, Val Acc: 70.21%, Best Val Acc: 70.21% (Epoch 3)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:30<00:00,  8.01it/s, loss=0.437, acc=86.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.56it/s]
Epoch 4/5 - Train Loss: 0.4367, Train Acc: 86.13%, Val Loss: 1.1691, Val Acc: 70.69%, Best Val Acc: 70.69% (Epoch 4)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:30<00:00,  8.01it/s, loss=0.412, acc=86.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.58it/s]
Epoch 5/5 - Train Loss: 0.4117, Train Acc: 86.73%, Val Loss: 1.1422, Val Acc: 71.76%, Best Val Acc: 71.76% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.44it/s]
Skipping GradCAM visualization for frozen models

Fold 6 Evaluation:
Test Loss: 1.1795, Test Accuracy: 67.91%

================================================================================
Training on Fold 7
Train Folds: [1, 2, 3, 4, 5, 8, 9, 10]
Val Fold: [6]
Test Fold: [7]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:31<00:00,  7.85it/s, loss=0.964, acc=71.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.31it/s]
Epoch 1/5 - Train Loss: 0.9635, Train Acc: 71.63%, Val Loss: 1.0834, Val Acc: 68.54%, Best Val Acc: 68.54% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:32<00:00,  7.84it/s, loss=0.572, acc=82.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.22it/s]
Epoch 2/5 - Train Loss: 0.5721, Train Acc: 82.43%, Val Loss: 1.0372, Val Acc: 70.55%, Best Val Acc: 70.55% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:32<00:00,  7.77it/s, loss=0.488, acc=84.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.31it/s]
Epoch 3/5 - Train Loss: 0.4876, Train Acc: 84.70%, Val Loss: 1.1001, Val Acc: 69.71%, Best Val Acc: 70.55% (Epoch 2)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:31<00:00,  7.88it/s, loss=0.443, acc=85.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.13it/s]
Epoch 4/5 - Train Loss: 0.4431, Train Acc: 85.77%, Val Loss: 1.1119, Val Acc: 70.43%, Best Val Acc: 70.55% (Epoch 2)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:32<00:00,  7.84it/s, loss=0.413, acc=86.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.46it/s]
Epoch 5/5 - Train Loss: 0.4132, Train Acc: 86.78%, Val Loss: 1.0941, Val Acc: 70.53%, Best Val Acc: 70.55% (Epoch 2)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.45it/s]
Skipping GradCAM visualization for frozen models

Fold 7 Evaluation:
Test Loss: 0.8933, Test Accuracy: 70.05%

================================================================================
Training on Fold 8
Train Folds: [1, 2, 3, 4, 5, 6, 9, 10]
Val Fold: [7]
Test Fold: [8]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:30<00:00,  7.97it/s, loss=0.959, acc=71.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.28it/s]
Epoch 1/5 - Train Loss: 0.9588, Train Acc: 71.79%, Val Loss: 0.9857, Val Acc: 68.13%, Best Val Acc: 68.13% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:34<00:00,  7.64it/s, loss=0.575, acc=82.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.71it/s]
Epoch 2/5 - Train Loss: 0.5748, Train Acc: 82.39%, Val Loss: 0.9590, Val Acc: 67.03%, Best Val Acc: 68.13% (Epoch 1)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:33<00:00,  7.72it/s, loss=0.489, acc=84.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.52it/s]
Epoch 3/5 - Train Loss: 0.4890, Train Acc: 84.73%, Val Loss: 0.9706, Val Acc: 69.14%, Best Val Acc: 69.14% (Epoch 3)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:33<00:00,  7.72it/s, loss=0.443, acc=86.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.15it/s]
Epoch 4/5 - Train Loss: 0.4427, Train Acc: 86.14%, Val Loss: 0.9843, Val Acc: 68.25%, Best Val Acc: 69.14% (Epoch 3)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:31<00:00,  7.95it/s, loss=0.413, acc=86.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  7.02it/s]
Epoch 5/5 - Train Loss: 0.4130, Train Acc: 86.90%, Val Loss: 0.9458, Val Acc: 70.15%, Best Val Acc: 70.15% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:13<00:00,  6.68it/s]
Skipping GradCAM visualization for frozen models

Fold 8 Evaluation:
Test Loss: 0.9133, Test Accuracy: 70.42%

================================================================================
Training on Fold 9
Train Folds: [1, 2, 3, 4, 5, 6, 7, 10]
Val Fold: [8]
Test Fold: [9]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:33<00:00,  7.82it/s, loss=0.98, acc=71.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.31it/s]
Epoch 1/5 - Train Loss: 0.9804, Train Acc: 71.17%, Val Loss: 0.9791, Val Acc: 65.29%, Best Val Acc: 65.29% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:34<00:00,  7.71it/s, loss=0.587, acc=82.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.51it/s]
Epoch 2/5 - Train Loss: 0.5868, Train Acc: 82.10%, Val Loss: 0.9401, Val Acc: 69.66%, Best Val Acc: 69.66% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:30<00:00,  8.05it/s, loss=0.501, acc=84.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.37it/s]
Epoch 3/5 - Train Loss: 0.5008, Train Acc: 84.54%, Val Loss: 0.9044, Val Acc: 69.78%, Best Val Acc: 69.78% (Epoch 3)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:31<00:00,  8.00it/s, loss=0.453, acc=85.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.45it/s]
Epoch 4/5 - Train Loss: 0.4526, Train Acc: 85.82%, Val Loss: 0.8935, Val Acc: 68.79%, Best Val Acc: 69.78% (Epoch 3)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:30<00:00,  8.01it/s, loss=0.424, acc=86.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.53it/s]
Epoch 5/5 - Train Loss: 0.4243, Train Acc: 86.70%, Val Loss: 0.9077, Val Acc: 69.85%, Best Val Acc: 69.85% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.43it/s]
Skipping GradCAM visualization for frozen models

Fold 9 Evaluation:
Test Loss: 0.8394, Test Accuracy: 76.91%

================================================================================
Training on Fold 10
Train Folds: [1, 2, 3, 4, 5, 6, 7, 8]
Val Fold: [9]
Test Fold: [10]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:33<00:00,  7.79it/s, loss=0.979, acc=70.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.13it/s]
Epoch 1/5 - Train Loss: 0.9787, Train Acc: 70.80%, Val Loss: 0.8345, Val Acc: 75.28%, Best Val Acc: 75.28% (Epoch 1)
Epoch 2:  44%|████████████████████████████████████████████▉                                                         | 320/727 [00:40<00:43,  9.33it/s, loss=0.621, acc=81.1]
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:30<00:00,  8.01it/s, loss=0.589, acc=81.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.15it/s]
Epoch 2/5 - Train Loss: 0.5891, Train Acc: 81.84%, Val Loss: 0.7566, Val Acc: 76.98%, Best Val Acc: 76.98% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:31<00:00,  7.97it/s, loss=0.502, acc=84.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.22it/s]
Epoch 3/5 - Train Loss: 0.5018, Train Acc: 84.45%, Val Loss: 0.7564, Val Acc: 77.42%, Best Val Acc: 77.42% (Epoch 3)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:32<00:00,  7.88it/s, loss=0.453, acc=85.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.19it/s]
Epoch 4/5 - Train Loss: 0.4532, Train Acc: 85.82%, Val Loss: 0.7733, Val Acc: 76.47%, Best Val Acc: 77.42% (Epoch 3)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:31<00:00,  7.94it/s, loss=0.427, acc=86.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.24it/s]
Epoch 5/5 - Train Loss: 0.4270, Train Acc: 86.39%, Val Loss: 0.7500, Val Acc: 76.89%, Best Val Acc: 77.42% (Epoch 3)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:11<00:00,  7.61it/s]
Skipping GradCAM visualization for frozen models

Fold 10 Evaluation:
Test Loss: 0.8382, Test Accuracy: 71.48%

================================================================================
Summary of results for resnet18
================================================================================
Average Test Accuracy: 71.02%
Individual Fold Test Accuracies: [70.03971680193403, 71.10881542699724, 69.86254295532646, 70.26009582477755, 72.20518064076346, 67.90801441565128, 70.05265839986411, 70.41880190846439, 76.90956979806847, 71.48102815177478]
Summary saved to output/resnet18/summary.json
Total execution time: 5336.65 seconds (1.48 hours)