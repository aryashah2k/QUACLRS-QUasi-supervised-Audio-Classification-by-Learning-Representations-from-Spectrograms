(base) jupyter-st125462@puffer:~/ExtendedUrbansound$ python train_kfold.py --model_name mobilenet --pretrained --freeze_features --batch_size 64 --epochs 5

================================================================================
Training on Fold 1
Train Folds: [2, 3, 4, 5, 6, 7, 8, 9]
Val Fold: [10]
Test Fold: [1]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:33<00:00,  7.80it/s, loss=0.951, acc=73.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.20it/s]
Epoch 1/5 - Train Loss: 0.9514, Train Acc: 73.54%, Val Loss: 0.7968, Val Acc: 74.00%, Best Val Acc: 74.00% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:31<00:00,  7.91it/s, loss=0.569, acc=82.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.43it/s]
Epoch 2/5 - Train Loss: 0.5688, Train Acc: 82.85%, Val Loss: 0.7820, Val Acc: 72.65%, Best Val Acc: 74.00% (Epoch 1)
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:31<00:00,  7.93it/s, loss=0.488, acc=85]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.48it/s]
Epoch 3/5 - Train Loss: 0.4876, Train Acc: 84.98%, Val Loss: 0.7716, Val Acc: 74.72%, Best Val Acc: 74.72% (Epoch 3)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:31<00:00,  7.91it/s, loss=0.444, acc=86]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.34it/s]
Epoch 4/5 - Train Loss: 0.4438, Train Acc: 85.95%, Val Loss: 0.7639, Val Acc: 75.56%, Best Val Acc: 75.56% (Epoch 4)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:30<00:00,  8.03it/s, loss=0.417, acc=86.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:11<00:00,  7.53it/s]
Epoch 5/5 - Train Loss: 0.4171, Train Acc: 86.86%, Val Loss: 0.7606, Val Acc: 75.97%, Best Val Acc: 75.97% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.16it/s]
Skipping GradCAM visualization for frozen models

Fold 1 Evaluation:
Test Loss: 0.7394, Test Accuracy: 74.22%

================================================================================
Training on Fold 2
Train Folds: [3, 4, 5, 6, 7, 8, 9, 10]
Val Fold: [1]
Test Fold: [2]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:31<00:00,  7.94it/s, loss=0.962, acc=73]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.45it/s]
Epoch 1/5 - Train Loss: 0.9619, Train Acc: 72.98%, Val Loss: 0.8395, Val Acc: 71.47%, Best Val Acc: 71.47% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:30<00:00,  8.00it/s, loss=0.573, acc=82.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.41it/s]
Epoch 2/5 - Train Loss: 0.5725, Train Acc: 82.68%, Val Loss: 0.8039, Val Acc: 73.18%, Best Val Acc: 73.18% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:31<00:00,  7.94it/s, loss=0.493, acc=84.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.28it/s]
Epoch 3/5 - Train Loss: 0.4927, Train Acc: 84.79%, Val Loss: 0.7760, Val Acc: 72.72%, Best Val Acc: 73.18% (Epoch 2)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:31<00:00,  7.90it/s, loss=0.447, acc=86.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.25it/s]
Epoch 4/5 - Train Loss: 0.4472, Train Acc: 86.11%, Val Loss: 0.7783, Val Acc: 73.53%, Best Val Acc: 73.53% (Epoch 4)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:31<00:00,  7.91it/s, loss=0.428, acc=86.3]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.44it/s]
Epoch 5/5 - Train Loss: 0.4275, Train Acc: 86.35%, Val Loss: 0.7698, Val Acc: 74.06%, Best Val Acc: 74.06% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.41it/s]
Skipping GradCAM visualization for frozen models

Fold 2 Evaluation:
Test Loss: 0.7589, Test Accuracy: 75.28%

================================================================================
Training on Fold 3
Train Folds: [1, 4, 5, 6, 7, 8, 9, 10]
Val Fold: [2]
Test Fold: [3]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:31<00:00,  7.91it/s, loss=0.957, acc=73.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.20it/s]
Epoch 1/5 - Train Loss: 0.9572, Train Acc: 73.46%, Val Loss: 0.8164, Val Acc: 73.42%, Best Val Acc: 73.42% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:32<00:00,  7.84it/s, loss=0.575, acc=82.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.21it/s]
Epoch 2/5 - Train Loss: 0.5751, Train Acc: 82.70%, Val Loss: 0.7851, Val Acc: 74.38%, Best Val Acc: 74.38% (Epoch 2)
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:32<00:00,  7.82it/s, loss=0.489, acc=85]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.42it/s]
Epoch 3/5 - Train Loss: 0.4894, Train Acc: 85.02%, Val Loss: 0.7905, Val Acc: 75.21%, Best Val Acc: 75.21% (Epoch 3)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:31<00:00,  7.89it/s, loss=0.447, acc=86]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.50it/s]
Epoch 4/5 - Train Loss: 0.4474, Train Acc: 86.03%, Val Loss: 0.7573, Val Acc: 75.41%, Best Val Acc: 75.41% (Epoch 4)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:30<00:00,  7.96it/s, loss=0.418, acc=86.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.27it/s]
Epoch 5/5 - Train Loss: 0.4181, Train Acc: 86.87%, Val Loss: 0.7977, Val Acc: 74.74%, Best Val Acc: 75.41% (Epoch 4)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.27it/s]
Skipping GradCAM visualization for frozen models

Fold 3 Evaluation:
Test Loss: 0.8119, Test Accuracy: 72.13%

================================================================================
Training on Fold 4
Train Folds: [1, 2, 5, 6, 7, 8, 9, 10]
Val Fold: [3]
Test Fold: [4]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:30<00:00,  7.99it/s, loss=0.954, acc=73.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.40it/s]
Epoch 1/5 - Train Loss: 0.9539, Train Acc: 73.36%, Val Loss: 0.8929, Val Acc: 72.13%, Best Val Acc: 72.13% (Epoch 1)
Epoch 2: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:29<00:00,  8.06it/s, loss=0.57, acc=82.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.36it/s]
Epoch 2/5 - Train Loss: 0.5697, Train Acc: 82.86%, Val Loss: 0.8593, Val Acc: 72.85%, Best Val Acc: 72.85% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:30<00:00,  8.02it/s, loss=0.483, acc=85.3]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.29it/s]
Epoch 3/5 - Train Loss: 0.4827, Train Acc: 85.27%, Val Loss: 0.8724, Val Acc: 72.35%, Best Val Acc: 72.85% (Epoch 2)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:29<00:00,  8.06it/s, loss=0.443, acc=86.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.28it/s]
Epoch 4/5 - Train Loss: 0.4427, Train Acc: 86.17%, Val Loss: 0.8381, Val Acc: 74.14%, Best Val Acc: 74.14% (Epoch 4)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:29<00:00,  8.11it/s, loss=0.415, acc=86.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.38it/s]
Epoch 5/5 - Train Loss: 0.4153, Train Acc: 86.85%, Val Loss: 0.8702, Val Acc: 73.33%, Best Val Acc: 74.14% (Epoch 4)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.34it/s]
Skipping GradCAM visualization for frozen models

Fold 4 Evaluation:
Test Loss: 0.7214, Test Accuracy: 75.58%

================================================================================
Training on Fold 5
Train Folds: [1, 2, 3, 6, 7, 8, 9, 10]
Val Fold: [4]
Test Fold: [5]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:31<00:00,  7.92it/s, loss=0.947, acc=73.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.28it/s]
Epoch 1/5 - Train Loss: 0.9473, Train Acc: 73.75%, Val Loss: 0.7721, Val Acc: 76.30%, Best Val Acc: 76.30% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:31<00:00,  7.92it/s, loss=0.562, acc=83.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.31it/s]
Epoch 2/5 - Train Loss: 0.5617, Train Acc: 83.17%, Val Loss: 0.7270, Val Acc: 77.10%, Best Val Acc: 77.10% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:30<00:00,  7.99it/s, loss=0.479, acc=85.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.40it/s]
Epoch 3/5 - Train Loss: 0.4788, Train Acc: 85.13%, Val Loss: 0.7105, Val Acc: 77.31%, Best Val Acc: 77.31% (Epoch 3)
Epoch 4: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:30<00:00,  7.97it/s, loss=0.44, acc=86.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.34it/s]
Epoch 4/5 - Train Loss: 0.4397, Train Acc: 86.13%, Val Loss: 0.6968, Val Acc: 77.48%, Best Val Acc: 77.48% (Epoch 4)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:30<00:00,  7.96it/s, loss=0.412, acc=86.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.48it/s]
Epoch 5/5 - Train Loss: 0.4123, Train Acc: 86.92%, Val Loss: 0.6798, Val Acc: 77.86%, Best Val Acc: 77.86% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.32it/s]
Skipping GradCAM visualization for frozen models

Fold 5 Evaluation:
Test Loss: 1.0023, Test Accuracy: 71.90%

================================================================================
Training on Fold 6
Train Folds: [1, 2, 3, 4, 7, 8, 9, 10]
Val Fold: [5]
Test Fold: [6]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:30<00:00,  7.98it/s, loss=0.927, acc=74.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.26it/s]
Epoch 1/5 - Train Loss: 0.9273, Train Acc: 74.56%, Val Loss: 1.0608, Val Acc: 67.52%, Best Val Acc: 67.52% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:30<00:00,  7.99it/s, loss=0.547, acc=83.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.30it/s]
Epoch 2/5 - Train Loss: 0.5468, Train Acc: 83.55%, Val Loss: 0.9780, Val Acc: 70.11%, Best Val Acc: 70.11% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:30<00:00,  8.01it/s, loss=0.465, acc=85.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.36it/s]
Epoch 3/5 - Train Loss: 0.4653, Train Acc: 85.74%, Val Loss: 0.9727, Val Acc: 70.40%, Best Val Acc: 70.40% (Epoch 3)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:30<00:00,  8.01it/s, loss=0.421, acc=86.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.60it/s]
Epoch 4/5 - Train Loss: 0.4213, Train Acc: 86.83%, Val Loss: 0.9830, Val Acc: 69.99%, Best Val Acc: 70.40% (Epoch 3)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:30<00:00,  7.96it/s, loss=0.397, acc=87.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.35it/s]
Epoch 5/5 - Train Loss: 0.3974, Train Acc: 87.39%, Val Loss: 0.9505, Val Acc: 71.05%, Best Val Acc: 71.05% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.29it/s]
Skipping GradCAM visualization for frozen models

Fold 6 Evaluation:
Test Loss: 0.9983, Test Accuracy: 67.51%

================================================================================
Training on Fold 7
Train Folds: [1, 2, 3, 4, 5, 8, 9, 10]
Val Fold: [6]
Test Fold: [7]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:30<00:00,  7.99it/s, loss=0.932, acc=74.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.32it/s]
Epoch 1/5 - Train Loss: 0.9324, Train Acc: 74.24%, Val Loss: 1.0176, Val Acc: 65.54%, Best Val Acc: 65.54% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:30<00:00,  8.00it/s, loss=0.547, acc=83.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.39it/s]
Epoch 2/5 - Train Loss: 0.5470, Train Acc: 83.76%, Val Loss: 1.0071, Val Acc: 67.51%, Best Val Acc: 67.51% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:30<00:00,  8.00it/s, loss=0.466, acc=85.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.39it/s]
Epoch 3/5 - Train Loss: 0.4658, Train Acc: 85.80%, Val Loss: 1.0107, Val Acc: 66.48%, Best Val Acc: 67.51% (Epoch 2)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:30<00:00,  8.00it/s, loss=0.426, acc=86.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.23it/s]
Epoch 4/5 - Train Loss: 0.4260, Train Acc: 86.55%, Val Loss: 0.9910, Val Acc: 66.26%, Best Val Acc: 67.51% (Epoch 2)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:32<00:00,  7.82it/s, loss=0.4, acc=87.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.22it/s]
Epoch 5/5 - Train Loss: 0.3996, Train Acc: 87.42%, Val Loss: 1.0324, Val Acc: 65.93%, Best Val Acc: 67.51% (Epoch 2)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.42it/s]
Skipping GradCAM visualization for frozen models

Fold 7 Evaluation:
Test Loss: 0.9080, Test Accuracy: 71.24%

================================================================================
Training on Fold 8
Train Folds: [1, 2, 3, 4, 5, 6, 9, 10]
Val Fold: [7]
Test Fold: [8]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:32<00:00,  7.86it/s, loss=0.929, acc=74.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.99it/s]
Epoch 1/5 - Train Loss: 0.9290, Train Acc: 74.49%, Val Loss: 0.9485, Val Acc: 69.95%, Best Val Acc: 69.95% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:32<00:00,  7.82it/s, loss=0.546, acc=83.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.37it/s]
Epoch 2/5 - Train Loss: 0.5465, Train Acc: 83.84%, Val Loss: 0.9201, Val Acc: 72.84%, Best Val Acc: 72.84% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:32<00:00,  7.83it/s, loss=0.468, acc=85.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.49it/s]
Epoch 3/5 - Train Loss: 0.4679, Train Acc: 85.75%, Val Loss: 0.9455, Val Acc: 72.53%, Best Val Acc: 72.84% (Epoch 2)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:31<00:00,  7.93it/s, loss=0.425, acc=86.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.28it/s]
Epoch 4/5 - Train Loss: 0.4253, Train Acc: 86.77%, Val Loss: 0.9587, Val Acc: 71.56%, Best Val Acc: 72.84% (Epoch 2)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:32<00:00,  7.86it/s, loss=0.401, acc=87.3]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.24it/s]
Epoch 5/5 - Train Loss: 0.4014, Train Acc: 87.34%, Val Loss: 0.9527, Val Acc: 72.07%, Best Val Acc: 72.84% (Epoch 2)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.38it/s]
Skipping GradCAM visualization for frozen models

Fold 8 Evaluation:
Test Loss: 0.9250, Test Accuracy: 70.42%

================================================================================
Training on Fold 9
Train Folds: [1, 2, 3, 4, 5, 6, 7, 10]
Val Fold: [8]
Test Fold: [9]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:34<00:00,  7.74it/s, loss=0.946, acc=73.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.48it/s]
Epoch 1/5 - Train Loss: 0.9457, Train Acc: 73.82%, Val Loss: 0.9958, Val Acc: 68.37%, Best Val Acc: 68.37% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:33<00:00,  7.75it/s, loss=0.557, acc=83.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.37it/s]
Epoch 2/5 - Train Loss: 0.5574, Train Acc: 83.56%, Val Loss: 0.9550, Val Acc: 68.95%, Best Val Acc: 68.95% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:32<00:00,  7.85it/s, loss=0.471, acc=85.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.30it/s]
Epoch 3/5 - Train Loss: 0.4712, Train Acc: 85.92%, Val Loss: 0.9365, Val Acc: 70.19%, Best Val Acc: 70.19% (Epoch 3)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:34<00:00,  7.72it/s, loss=0.431, acc=86.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.38it/s]
Epoch 4/5 - Train Loss: 0.4307, Train Acc: 86.53%, Val Loss: 0.9204, Val Acc: 70.14%, Best Val Acc: 70.19% (Epoch 3)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:33<00:00,  7.78it/s, loss=0.407, acc=87.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.28it/s]
Epoch 5/5 - Train Loss: 0.4070, Train Acc: 87.21%, Val Loss: 0.9120, Val Acc: 71.92%, Best Val Acc: 71.92% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.06it/s]
Skipping GradCAM visualization for frozen models

Fold 9 Evaluation:
Test Loss: 0.7452, Test Accuracy: 75.91%

================================================================================
Training on Fold 10
Train Folds: [1, 2, 3, 4, 5, 6, 7, 8]
Val Fold: [9]
Test Fold: [10]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:34<00:00,  7.66it/s, loss=0.951, acc=73.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.01it/s]
Epoch 1/5 - Train Loss: 0.9508, Train Acc: 73.79%, Val Loss: 0.8017, Val Acc: 74.21%, Best Val Acc: 74.21% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:34<00:00,  7.66it/s, loss=0.563, acc=83.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  6.97it/s]
Epoch 2/5 - Train Loss: 0.5630, Train Acc: 83.23%, Val Loss: 0.7406, Val Acc: 74.71%, Best Val Acc: 74.71% (Epoch 2)
Epoch 3: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:31<00:00,  7.92it/s, loss=0.48, acc=85.3]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.28it/s]
Epoch 3/5 - Train Loss: 0.4804, Train Acc: 85.30%, Val Loss: 0.7507, Val Acc: 74.40%, Best Val Acc: 74.71% (Epoch 2)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:31<00:00,  7.98it/s, loss=0.441, acc=86.3]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.21it/s]
Epoch 4/5 - Train Loss: 0.4408, Train Acc: 86.26%, Val Loss: 0.7246, Val Acc: 74.86%, Best Val Acc: 74.86% (Epoch 4)
Epoch 5: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:32<00:00,  7.83it/s, loss=0.41, acc=87.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.14it/s]
Epoch 5/5 - Train Loss: 0.4103, Train Acc: 87.07%, Val Loss: 0.7255, Val Acc: 75.73%, Best Val Acc: 75.73% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.35it/s]
Skipping GradCAM visualization for frozen models

Fold 10 Evaluation:
Test Loss: 0.7384, Test Accuracy: 75.66%

================================================================================
Summary of results for mobilenet
================================================================================
Average Test Accuracy: 72.98%
Individual Fold Test Accuracies: [74.21861509238474, 75.27548209366391, 72.13058419243987, 75.58179329226557, 71.8984321745058, 67.5133001544534, 71.24171904195686, 70.41880190846439, 75.90869183494293, 75.66008043364225]
Summary saved to output/mobilenet/summary.json
Total execution time: 5352.11 seconds (1.49 hours)