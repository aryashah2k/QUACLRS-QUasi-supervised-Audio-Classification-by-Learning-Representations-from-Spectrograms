(base) jupyter-st125462@puffer:~/ExtendedUrbansound$ python train_kfold.py --model_name efficientnet --pretrained --freeze_features --batch_size 64 --epochs 5

================================================================================
Training on Fold 1
Train Folds: [2, 3, 4, 5, 6, 7, 8, 9]
Val Fold: [10]
Test Fold: [1]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:31<00:00,  7.94it/s, loss=0.885, acc=74.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:11<00:00,  7.50it/s]
Epoch 1/5 - Train Loss: 0.8850, Train Acc: 74.87%, Val Loss: 0.8201, Val Acc: 73.68%, Best Val Acc: 73.68% (Epoch 1)
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:34<00:00,  7.70it/s, loss=0.553, acc=83]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.24it/s]
Epoch 2/5 - Train Loss: 0.5532, Train Acc: 83.04%, Val Loss: 0.8027, Val Acc: 73.84%, Best Val Acc: 73.84% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:32<00:00,  7.89it/s, loss=0.484, acc=84.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.29it/s]
Epoch 3/5 - Train Loss: 0.4837, Train Acc: 84.86%, Val Loss: 0.7492, Val Acc: 75.96%, Best Val Acc: 75.96% (Epoch 3)
Epoch 4: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:32<00:00,  7.88it/s, loss=0.45, acc=85.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.35it/s]
Epoch 4/5 - Train Loss: 0.4502, Train Acc: 85.73%, Val Loss: 0.7707, Val Acc: 76.15%, Best Val Acc: 76.15% (Epoch 4)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:32<00:00,  7.87it/s, loss=0.43, acc=86]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.38it/s]
Epoch 5/5 - Train Loss: 0.4296, Train Acc: 86.01%, Val Loss: 0.7241, Val Acc: 77.90%, Best Val Acc: 77.90% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:13<00:00,  6.91it/s]
Skipping GradCAM visualization for frozen models

Fold 1 Evaluation:
Test Loss: 0.7170, Test Accuracy: 75.00%

================================================================================
Training on Fold 2
Train Folds: [3, 4, 5, 6, 7, 8, 9, 10]
Val Fold: [1]
Test Fold: [2]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:32<00:00,  7.85it/s, loss=0.894, acc=74.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.43it/s]
Epoch 1/5 - Train Loss: 0.8937, Train Acc: 74.43%, Val Loss: 0.8048, Val Acc: 71.78%, Best Val Acc: 71.78% (Epoch 1)
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:31<00:00,  7.91it/s, loss=0.557, acc=83]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.27it/s]
Epoch 2/5 - Train Loss: 0.5569, Train Acc: 83.03%, Val Loss: 0.7488, Val Acc: 73.58%, Best Val Acc: 73.58% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:31<00:00,  7.90it/s, loss=0.487, acc=84.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.25it/s]
Epoch 3/5 - Train Loss: 0.4875, Train Acc: 84.69%, Val Loss: 0.7618, Val Acc: 72.42%, Best Val Acc: 73.58% (Epoch 2)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:31<00:00,  7.91it/s, loss=0.453, acc=85.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.29it/s]
Epoch 4/5 - Train Loss: 0.4529, Train Acc: 85.66%, Val Loss: 0.7511, Val Acc: 73.86%, Best Val Acc: 73.86% (Epoch 4)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:31<00:00,  7.89it/s, loss=0.431, acc=86.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.37it/s]
Epoch 5/5 - Train Loss: 0.4311, Train Acc: 86.07%, Val Loss: 0.7263, Val Acc: 73.94%, Best Val Acc: 73.94% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.40it/s]
Skipping GradCAM visualization for frozen models

Fold 2 Evaluation:
Test Loss: 0.8981, Test Accuracy: 72.11%

================================================================================
Training on Fold 3
Train Folds: [1, 4, 5, 6, 7, 8, 9, 10]
Val Fold: [2]
Test Fold: [3]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:31<00:00,  7.88it/s, loss=0.887, acc=75]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.13it/s]
Epoch 1/5 - Train Loss: 0.8871, Train Acc: 74.96%, Val Loss: 0.8757, Val Acc: 70.51%, Best Val Acc: 70.51% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:30<00:00,  7.96it/s, loss=0.551, acc=83.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.25it/s]
Epoch 2/5 - Train Loss: 0.5509, Train Acc: 83.23%, Val Loss: 0.8501, Val Acc: 71.35%, Best Val Acc: 71.35% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:31<00:00,  7.89it/s, loss=0.483, acc=84.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.24it/s]
Epoch 3/5 - Train Loss: 0.4827, Train Acc: 84.93%, Val Loss: 0.8261, Val Acc: 72.97%, Best Val Acc: 72.97% (Epoch 3)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:32<00:00,  7.87it/s, loss=0.449, acc=85.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.43it/s]
Epoch 4/5 - Train Loss: 0.4488, Train Acc: 85.87%, Val Loss: 0.8412, Val Acc: 71.99%, Best Val Acc: 72.97% (Epoch 3)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:32<00:00,  7.81it/s, loss=0.426, acc=86.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.32it/s]
Epoch 5/5 - Train Loss: 0.4261, Train Acc: 86.37%, Val Loss: 0.8589, Val Acc: 72.68%, Best Val Acc: 72.97% (Epoch 3)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.29it/s]
Skipping GradCAM visualization for frozen models

Fold 3 Evaluation:
Test Loss: 0.7327, Test Accuracy: 76.94%

================================================================================
Training on Fold 4
Train Folds: [1, 2, 5, 6, 7, 8, 9, 10]
Val Fold: [3]
Test Fold: [4]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:31<00:00,  7.86it/s, loss=0.881, acc=75.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.22it/s]
Epoch 1/5 - Train Loss: 0.8811, Train Acc: 75.17%, Val Loss: 0.8311, Val Acc: 72.11%, Best Val Acc: 72.11% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:30<00:00,  7.95it/s, loss=0.548, acc=83.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.37it/s]
Epoch 2/5 - Train Loss: 0.5479, Train Acc: 83.53%, Val Loss: 0.7728, Val Acc: 75.12%, Best Val Acc: 75.12% (Epoch 2)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:31<00:00,  7.91it/s, loss=0.48, acc=85]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.34it/s]
Epoch 3/5 - Train Loss: 0.4797, Train Acc: 84.97%, Val Loss: 0.7495, Val Acc: 75.55%, Best Val Acc: 75.55% (Epoch 3)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:31<00:00,  7.94it/s, loss=0.451, acc=85.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.47it/s]
Epoch 4/5 - Train Loss: 0.4508, Train Acc: 85.66%, Val Loss: 0.7546, Val Acc: 76.79%, Best Val Acc: 76.79% (Epoch 4)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:31<00:00,  7.90it/s, loss=0.423, acc=86.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.18it/s]
Epoch 5/5 - Train Loss: 0.4234, Train Acc: 86.44%, Val Loss: 0.7532, Val Acc: 76.58%, Best Val Acc: 76.79% (Epoch 4)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.19it/s]
Skipping GradCAM visualization for frozen models

Fold 4 Evaluation:
Test Loss: 0.7839, Test Accuracy: 74.04%

================================================================================
Training on Fold 5
Train Folds: [1, 2, 3, 6, 7, 8, 9, 10]
Val Fold: [4]
Test Fold: [5]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:32<00:00,  7.77it/s, loss=0.882, acc=74.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.24it/s]
Epoch 1/5 - Train Loss: 0.8824, Train Acc: 74.94%, Val Loss: 0.7767, Val Acc: 73.44%, Best Val Acc: 73.44% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:32<00:00,  7.82it/s, loss=0.547, acc=83.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.22it/s]
Epoch 2/5 - Train Loss: 0.5472, Train Acc: 83.37%, Val Loss: 0.7497, Val Acc: 73.85%, Best Val Acc: 73.85% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:34<00:00,  7.67it/s, loss=0.479, acc=85.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.19it/s]
Epoch 3/5 - Train Loss: 0.4787, Train Acc: 85.15%, Val Loss: 0.7462, Val Acc: 73.90%, Best Val Acc: 73.90% (Epoch 3)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:33<00:00,  7.76it/s, loss=0.447, acc=85.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.33it/s]
Epoch 4/5 - Train Loss: 0.4473, Train Acc: 85.79%, Val Loss: 0.7336, Val Acc: 75.53%, Best Val Acc: 75.53% (Epoch 4)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:32<00:00,  7.80it/s, loss=0.427, acc=86.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.18it/s]
Epoch 5/5 - Train Loss: 0.4270, Train Acc: 86.24%, Val Loss: 0.7599, Val Acc: 74.26%, Best Val Acc: 75.53% (Epoch 4)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.52it/s]
Skipping GradCAM visualization for frozen models

Fold 5 Evaluation:
Test Loss: 0.9773, Test Accuracy: 72.38%

================================================================================
Training on Fold 6
Train Folds: [1, 2, 3, 4, 7, 8, 9, 10]
Val Fold: [5]
Test Fold: [6]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:31<00:00,  7.93it/s, loss=0.872, acc=75.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.39it/s]
Epoch 1/5 - Train Loss: 0.8720, Train Acc: 75.17%, Val Loss: 0.9149, Val Acc: 71.80%, Best Val Acc: 71.80% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:31<00:00,  7.87it/s, loss=0.542, acc=83.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.35it/s]
Epoch 2/5 - Train Loss: 0.5420, Train Acc: 83.52%, Val Loss: 0.8951, Val Acc: 72.38%, Best Val Acc: 72.38% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:31<00:00,  7.88it/s, loss=0.475, acc=85.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.40it/s]
Epoch 3/5 - Train Loss: 0.4749, Train Acc: 85.12%, Val Loss: 0.9193, Val Acc: 72.56%, Best Val Acc: 72.56% (Epoch 3)
Epoch 4:  38%|██████████████████████████████████████▌                                                               | 273/723 [00:36<00:44, 10.21it/s, loss=0.449, acc=85.9]Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:33<00:00,  7.71it/s, loss=0.439, acc=85.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.48it/s]
Epoch 4/5 - Train Loss: 0.4394, Train Acc: 85.94%, Val Loss: 0.9074, Val Acc: 73.35%, Best Val Acc: 73.35% (Epoch 4)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:31<00:00,  7.88it/s, loss=0.418, acc=86.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.49it/s]
Epoch 5/5 - Train Loss: 0.4183, Train Acc: 86.44%, Val Loss: 0.8920, Val Acc: 74.40%, Best Val Acc: 74.40% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.18it/s]
Skipping GradCAM visualization for frozen models

Fold 6 Evaluation:
Test Loss: 1.0670, Test Accuracy: 70.86%

================================================================================
Training on Fold 7
Train Folds: [1, 2, 3, 4, 5, 8, 9, 10]
Val Fold: [6]
Test Fold: [7]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:33<00:00,  7.76it/s, loss=0.876, acc=75.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  7.06it/s]
Epoch 1/5 - Train Loss: 0.8762, Train Acc: 75.64%, Val Loss: 1.0400, Val Acc: 68.53%, Best Val Acc: 68.53% (Epoch 1)
Epoch 2: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:33<00:00,  7.74it/s, loss=0.54, acc=83.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.12it/s]
Epoch 2/5 - Train Loss: 0.5400, Train Acc: 83.64%, Val Loss: 1.0317, Val Acc: 70.40%, Best Val Acc: 70.40% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:32<00:00,  7.77it/s, loss=0.472, acc=85.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.40it/s]
Epoch 3/5 - Train Loss: 0.4716, Train Acc: 85.48%, Val Loss: 1.0483, Val Acc: 70.12%, Best Val Acc: 70.40% (Epoch 2)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:32<00:00,  7.85it/s, loss=0.439, acc=86]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.34it/s]
Epoch 4/5 - Train Loss: 0.4389, Train Acc: 86.00%, Val Loss: 1.0660, Val Acc: 71.08%, Best Val Acc: 71.08% (Epoch 4)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:32<00:00,  7.78it/s, loss=0.417, acc=86.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.30it/s]
Epoch 5/5 - Train Loss: 0.4167, Train Acc: 86.61%, Val Loss: 1.0841, Val Acc: 70.93%, Best Val Acc: 71.08% (Epoch 4)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.31it/s]
Skipping GradCAM visualization for frozen models

Fold 7 Evaluation:
Test Loss: 0.8616, Test Accuracy: 75.25%

================================================================================
Training on Fold 8
Train Folds: [1, 2, 3, 4, 5, 6, 9, 10]
Val Fold: [7]
Test Fold: [8]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:33<00:00,  7.77it/s, loss=0.877, acc=75.3]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.10it/s]
Epoch 1/5 - Train Loss: 0.8773, Train Acc: 75.28%, Val Loss: 0.8124, Val Acc: 75.73%, Best Val Acc: 75.73% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:34<00:00,  7.69it/s, loss=0.547, acc=83.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.30it/s]
Epoch 2/5 - Train Loss: 0.5469, Train Acc: 83.62%, Val Loss: 0.7941, Val Acc: 77.34%, Best Val Acc: 77.34% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:33<00:00,  7.76it/s, loss=0.475, acc=85.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.27it/s]
Epoch 3/5 - Train Loss: 0.4748, Train Acc: 85.47%, Val Loss: 0.7945, Val Acc: 76.76%, Best Val Acc: 77.34% (Epoch 2)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:35<00:00,  7.62it/s, loss=0.441, acc=86]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.08it/s]
Epoch 4/5 - Train Loss: 0.4411, Train Acc: 85.96%, Val Loss: 0.8354, Val Acc: 76.83%, Best Val Acc: 77.34% (Epoch 2)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:34<00:00,  7.68it/s, loss=0.419, acc=86.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.87it/s]
Epoch 5/5 - Train Loss: 0.4192, Train Acc: 86.64%, Val Loss: 0.8163, Val Acc: 77.05%, Best Val Acc: 77.34% (Epoch 2)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.37it/s]
Skipping GradCAM visualization for frozen models

Fold 8 Evaluation:
Test Loss: 0.8764, Test Accuracy: 72.89%

================================================================================
Training on Fold 9
Train Folds: [1, 2, 3, 4, 5, 6, 7, 10]
Val Fold: [8]
Test Fold: [9]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:32<00:00,  7.87it/s, loss=0.881, acc=75.3]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.45it/s]
Epoch 1/5 - Train Loss: 0.8806, Train Acc: 75.30%, Val Loss: 0.8728, Val Acc: 72.08%, Best Val Acc: 72.08% (Epoch 1)
Epoch 2: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:33<00:00,  7.80it/s, loss=0.55, acc=83.3]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.38it/s]
Epoch 2/5 - Train Loss: 0.5503, Train Acc: 83.31%, Val Loss: 0.8475, Val Acc: 70.65%, Best Val Acc: 72.08% (Epoch 1)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:33<00:00,  7.76it/s, loss=0.479, acc=85.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.43it/s]
Epoch 3/5 - Train Loss: 0.4794, Train Acc: 85.11%, Val Loss: 0.8261, Val Acc: 71.89%, Best Val Acc: 72.08% (Epoch 1)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:33<00:00,  7.83it/s, loss=0.445, acc=85.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.57it/s]
Epoch 4/5 - Train Loss: 0.4454, Train Acc: 85.82%, Val Loss: 0.8532, Val Acc: 70.95%, Best Val Acc: 72.08% (Epoch 1)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:31<00:00,  7.91it/s, loss=0.426, acc=86.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.45it/s]
Epoch 5/5 - Train Loss: 0.4259, Train Acc: 86.39%, Val Loss: 0.8644, Val Acc: 70.08%, Best Val Acc: 72.08% (Epoch 1)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.23it/s]
Skipping GradCAM visualization for frozen models

Fold 9 Evaluation:
Test Loss: 0.7737, Test Accuracy: 76.47%

================================================================================
Training on Fold 10
Train Folds: [1, 2, 3, 4, 5, 6, 7, 8]
Val Fold: [9]
Test Fold: [10]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:33<00:00,  7.76it/s, loss=0.881, acc=75.3]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.22it/s]
Epoch 1/5 - Train Loss: 0.8812, Train Acc: 75.27%, Val Loss: 0.7460, Val Acc: 77.33%, Best Val Acc: 77.33% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:33<00:00,  7.81it/s, loss=0.551, acc=83.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  6.98it/s]
Epoch 2/5 - Train Loss: 0.5506, Train Acc: 83.13%, Val Loss: 0.7290, Val Acc: 77.56%, Best Val Acc: 77.56% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:33<00:00,  7.82it/s, loss=0.481, acc=84.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.20it/s]
Epoch 3/5 - Train Loss: 0.4815, Train Acc: 84.91%, Val Loss: 0.7327, Val Acc: 76.40%, Best Val Acc: 77.56% (Epoch 2)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:33<00:00,  7.78it/s, loss=0.449, acc=85.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.03it/s]
Epoch 4/5 - Train Loss: 0.4490, Train Acc: 85.66%, Val Loss: 0.7397, Val Acc: 76.84%, Best Val Acc: 77.56% (Epoch 2)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:33<00:00,  7.80it/s, loss=0.427, acc=86.3]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.15it/s]
Epoch 5/5 - Train Loss: 0.4269, Train Acc: 86.33%, Val Loss: 0.7704, Val Acc: 76.84%, Best Val Acc: 77.56% (Epoch 2)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.19it/s]
Skipping GradCAM visualization for frozen models

Fold 10 Evaluation:
Test Loss: 0.7847, Test Accuracy: 74.63%

================================================================================
Summary of results for efficientnet
================================================================================
Average Test Accuracy: 74.06%
Individual Fold Test Accuracies: [74.99568295631151, 72.10743801652893, 76.94158075601375, 74.04175222450377, 72.37559645535106, 70.85979062982666, 75.25055206386955, 72.89273723272663, 76.47058823529412, 74.62843154397622]
Summary saved to output/efficientnet/summary.json
Total execution time: 5408.64 seconds (1.50 hours)