(base) jupyter-st125462@puffer:~/ExtendedUrbansound$ python train_kfold.py --model_name convnext --pretrained --freeze_features --batch_size 64 --epochs 5

================================================================================
Train Folds: [2, 3, 4, 5, 6, 7, 8, 9]
Val Fold: [10]
Test Fold: [1]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:39<00:00,  7.28it/s, loss=0.783, acc=77.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.12it/s]
Epoch 1/5 - Train Loss: 0.7833, Train Acc: 77.16%, Val Loss: 0.6444, Val Acc: 78.84%, Best Val Acc: 78.84% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:36<00:00,  7.53it/s, loss=0.424, acc=87.3]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  6.97it/s]
Epoch 2/5 - Train Loss: 0.4236, Train Acc: 87.30%, Val Loss: 0.6061, Val Acc: 81.40%, Best Val Acc: 81.40% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:36<00:00,  7.51it/s, loss=0.343, acc=89.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  6.95it/s]
Epoch 3/5 - Train Loss: 0.3427, Train Acc: 89.72%, Val Loss: 0.5815, Val Acc: 81.57%, Best Val Acc: 81.57% (Epoch 3)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:37<00:00,  7.44it/s, loss=0.293, acc=91]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  6.93it/s]
Epoch 4/5 - Train Loss: 0.2929, Train Acc: 91.02%, Val Loss: 0.6021, Val Acc: 80.24%, Best Val Acc: 81.57% (Epoch 3)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:36<00:00,  7.53it/s, loss=0.268, acc=91.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.02it/s]
Epoch 5/5 - Train Loss: 0.2682, Train Acc: 91.89%, Val Loss: 0.5946, Val Acc: 81.92%, Best Val Acc: 81.92% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.19it/s]
Skipping GradCAM visualization for frozen models

Fold 1 Evaluation:
Test Loss: 0.5561, Test Accuracy: 80.04%

================================================================================
Training on Fold 2
Train Folds: [3, 4, 5, 6, 7, 8, 9, 10]
Val Fold: [1]
Test Fold: [2]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:36<00:00,  7.50it/s, loss=0.792, acc=77]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.03it/s]
Epoch 1/5 - Train Loss: 0.7919, Train Acc: 77.04%, Val Loss: 0.6252, Val Acc: 80.19%, Best Val Acc: 80.19% (Epoch 1)
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:37<00:00,  7.42it/s, loss=0.428, acc=87]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:13<00:00,  6.97it/s]
Epoch 2/5 - Train Loss: 0.4281, Train Acc: 87.00%, Val Loss: 0.6024, Val Acc: 80.09%, Best Val Acc: 80.19% (Epoch 1)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:36<00:00,  7.49it/s, loss=0.347, acc=89.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:13<00:00,  6.88it/s]
Epoch 3/5 - Train Loss: 0.3474, Train Acc: 89.37%, Val Loss: 0.5693, Val Acc: 80.56%, Best Val Acc: 80.56% (Epoch 3)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:36<00:00,  7.52it/s, loss=0.3, acc=90.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:13<00:00,  6.93it/s]
Epoch 4/5 - Train Loss: 0.3004, Train Acc: 90.81%, Val Loss: 0.5503, Val Acc: 81.51%, Best Val Acc: 81.51% (Epoch 4)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:37<00:00,  7.42it/s, loss=0.271, acc=91.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.11it/s]
Epoch 5/5 - Train Loss: 0.2707, Train Acc: 91.58%, Val Loss: 0.5666, Val Acc: 81.61%, Best Val Acc: 81.61% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:13<00:00,  6.83it/s]
Skipping GradCAM visualization for frozen models

Fold 2 Evaluation:
Test Loss: 0.6970, Test Accuracy: 78.10%

================================================================================
Training on Fold 3
Train Folds: [1, 4, 5, 6, 7, 8, 9, 10]
Val Fold: [2]
Test Fold: [3]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:36<00:00,  7.52it/s, loss=0.788, acc=77.3]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.05it/s]
Epoch 1/5 - Train Loss: 0.7885, Train Acc: 77.28%, Val Loss: 0.7327, Val Acc: 76.41%, Best Val Acc: 76.41% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:36<00:00,  7.50it/s, loss=0.427, acc=87.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:13<00:00,  6.96it/s]
Epoch 2/5 - Train Loss: 0.4274, Train Acc: 87.10%, Val Loss: 0.7020, Val Acc: 77.55%, Best Val Acc: 77.55% (Epoch 2)
Epoch 3: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:37<00:00,  7.41it/s, loss=0.34, acc=89.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:13<00:00,  6.98it/s]
Epoch 3/5 - Train Loss: 0.3399, Train Acc: 89.78%, Val Loss: 0.7072, Val Acc: 78.89%, Best Val Acc: 78.89% (Epoch 3)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:38<00:00,  7.33it/s, loss=0.297, acc=90.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.14it/s]
Epoch 4/5 - Train Loss: 0.2965, Train Acc: 90.82%, Val Loss: 0.6957, Val Acc: 77.96%, Best Val Acc: 78.89% (Epoch 3)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:36<00:00,  7.47it/s, loss=0.268, acc=91.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:13<00:00,  6.88it/s]
Epoch 5/5 - Train Loss: 0.2679, Train Acc: 91.83%, Val Loss: 0.6588, Val Acc: 79.24%, Best Val Acc: 79.24% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:13<00:00,  6.75it/s]
Skipping GradCAM visualization for frozen models

Fold 3 Evaluation:
Test Loss: 0.6372, Test Accuracy: 78.93%

================================================================================
Training on Fold 4
Train Folds: [1, 2, 5, 6, 7, 8, 9, 10]
Val Fold: [3]
Test Fold: [4]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:35<00:00,  7.61it/s, loss=0.789, acc=77]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:13<00:00,  6.93it/s]
Epoch 1/5 - Train Loss: 0.7891, Train Acc: 76.98%, Val Loss: 0.6601, Val Acc: 77.25%, Best Val Acc: 77.25% (Epoch 1)
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:36<00:00,  7.53it/s, loss=0.427, acc=87]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.01it/s]
Epoch 2/5 - Train Loss: 0.4274, Train Acc: 87.00%, Val Loss: 0.6481, Val Acc: 76.70%, Best Val Acc: 77.25% (Epoch 1)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:35<00:00,  7.58it/s, loss=0.345, acc=89.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:13<00:00,  6.79it/s]
Epoch 3/5 - Train Loss: 0.3453, Train Acc: 89.50%, Val Loss: 0.6207, Val Acc: 77.47%, Best Val Acc: 77.47% (Epoch 3)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:36<00:00,  7.49it/s, loss=0.302, acc=90.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:13<00:00,  6.98it/s]
Epoch 4/5 - Train Loss: 0.3020, Train Acc: 90.68%, Val Loss: 0.6318, Val Acc: 79.52%, Best Val Acc: 79.52% (Epoch 4)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:36<00:00,  7.52it/s, loss=0.273, acc=91.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.05it/s]
Epoch 5/5 - Train Loss: 0.2731, Train Acc: 91.55%, Val Loss: 0.6588, Val Acc: 77.13%, Best Val Acc: 79.52% (Epoch 4)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.96it/s]
Skipping GradCAM visualization for frozen models

Fold 4 Evaluation:
Test Loss: 0.4770, Test Accuracy: 84.86%

================================================================================
Training on Fold 5
Train Folds: [1, 2, 3, 6, 7, 8, 9, 10]
Val Fold: [4]
Test Fold: [5]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:37<00:00,  7.39it/s, loss=0.782, acc=76.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.94it/s]
Epoch 1/5 - Train Loss: 0.7824, Train Acc: 76.86%, Val Loss: 0.6125, Val Acc: 80.24%, Best Val Acc: 80.24% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:37<00:00,  7.39it/s, loss=0.432, acc=86.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  7.01it/s]
Epoch 2/5 - Train Loss: 0.4321, Train Acc: 86.55%, Val Loss: 0.5168, Val Acc: 82.60%, Best Val Acc: 82.60% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:37<00:00,  7.44it/s, loss=0.347, acc=89.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.92it/s]
Epoch 3/5 - Train Loss: 0.3471, Train Acc: 89.18%, Val Loss: 0.4734, Val Acc: 85.01%, Best Val Acc: 85.01% (Epoch 3)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:39<00:00,  7.24it/s, loss=0.305, acc=90.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.97it/s]
Epoch 4/5 - Train Loss: 0.3049, Train Acc: 90.52%, Val Loss: 0.4640, Val Acc: 84.22%, Best Val Acc: 85.01% (Epoch 3)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:38<00:00,  7.30it/s, loss=0.277, acc=91.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.74it/s]
Epoch 5/5 - Train Loss: 0.2773, Train Acc: 91.47%, Val Loss: 0.4510, Val Acc: 84.29%, Best Val Acc: 85.01% (Epoch 3)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.86it/s]
Skipping GradCAM visualization for frozen models

Fold 5 Evaluation:
Test Loss: 0.8557, Test Accuracy: 81.27%

================================================================================
Training on Fold 6
Train Folds: [1, 2, 3, 4, 7, 8, 9, 10]
Val Fold: [5]
Test Fold: [6]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:39<00:00,  7.28it/s, loss=0.774, acc=77.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.87it/s]
Epoch 1/5 - Train Loss: 0.7737, Train Acc: 77.11%, Val Loss: 0.8951, Val Acc: 77.37%, Best Val Acc: 77.37% (Epoch 1)
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:38<00:00,  7.36it/s, loss=0.423, acc=87]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.83it/s]
Epoch 2/5 - Train Loss: 0.4231, Train Acc: 87.02%, Val Loss: 0.9065, Val Acc: 80.28%, Best Val Acc: 80.28% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:39<00:00,  7.23it/s, loss=0.337, acc=89.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.92it/s]
Epoch 3/5 - Train Loss: 0.3370, Train Acc: 89.65%, Val Loss: 0.7864, Val Acc: 81.70%, Best Val Acc: 81.70% (Epoch 3)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:40<00:00,  7.16it/s, loss=0.296, acc=90.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.66it/s]
Epoch 4/5 - Train Loss: 0.2962, Train Acc: 90.78%, Val Loss: 0.9289, Val Acc: 81.90%, Best Val Acc: 81.90% (Epoch 4)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:40<00:00,  7.20it/s, loss=0.268, acc=91.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.71it/s]
Epoch 5/5 - Train Loss: 0.2676, Train Acc: 91.57%, Val Loss: 0.8903, Val Acc: 81.71%, Best Val Acc: 81.90% (Epoch 4)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.73it/s]
Skipping GradCAM visualization for frozen models

Fold 6 Evaluation:
Test Loss: 0.8270, Test Accuracy: 77.18%

================================================================================
Training on Fold 7
Train Folds: [1, 2, 3, 4, 5, 8, 9, 10]
Val Fold: [6]
Test Fold: [7]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:37<00:00,  7.42it/s, loss=0.773, acc=77.3]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.98it/s]
Epoch 1/5 - Train Loss: 0.7733, Train Acc: 77.32%, Val Loss: 0.7737, Val Acc: 75.53%, Best Val Acc: 75.53% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:37<00:00,  7.38it/s, loss=0.419, acc=87.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.80it/s]
Epoch 2/5 - Train Loss: 0.4186, Train Acc: 87.07%, Val Loss: 0.7295, Val Acc: 77.60%, Best Val Acc: 77.60% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:38<00:00,  7.35it/s, loss=0.337, acc=89.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.94it/s]
Epoch 3/5 - Train Loss: 0.3373, Train Acc: 89.47%, Val Loss: 0.7549, Val Acc: 77.19%, Best Val Acc: 77.60% (Epoch 2)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:38<00:00,  7.33it/s, loss=0.293, acc=90.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.90it/s]
Epoch 4/5 - Train Loss: 0.2928, Train Acc: 90.91%, Val Loss: 0.7625, Val Acc: 76.88%, Best Val Acc: 77.60% (Epoch 2)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:38<00:00,  7.30it/s, loss=0.265, acc=91.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.87it/s]
Epoch 5/5 - Train Loss: 0.2649, Train Acc: 91.58%, Val Loss: 0.7802, Val Acc: 78.50%, Best Val Acc: 78.50% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.75it/s]
Skipping GradCAM visualization for frozen models

Fold 7 Evaluation:
Test Loss: 0.7600, Test Accuracy: 78.26%

================================================================================
Training on Fold 8
Train Folds: [1, 2, 3, 4, 5, 6, 9, 10]
Val Fold: [7]
Test Fold: [8]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:39<00:00,  7.29it/s, loss=0.772, acc=77.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.81it/s]
Epoch 1/5 - Train Loss: 0.7717, Train Acc: 77.65%, Val Loss: 0.8176, Val Acc: 75.78%, Best Val Acc: 75.78% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:38<00:00,  7.33it/s, loss=0.413, acc=87.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.80it/s]
Epoch 2/5 - Train Loss: 0.4132, Train Acc: 87.52%, Val Loss: 0.7241, Val Acc: 78.43%, Best Val Acc: 78.43% (Epoch 2)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:39<00:00,  7.28it/s, loss=0.33, acc=90]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.87it/s]
Epoch 3/5 - Train Loss: 0.3304, Train Acc: 90.03%, Val Loss: 0.7627, Val Acc: 79.23%, Best Val Acc: 79.23% (Epoch 3)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:39<00:00,  7.31it/s, loss=0.287, acc=91.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.76it/s]
Epoch 4/5 - Train Loss: 0.2874, Train Acc: 91.40%, Val Loss: 0.7105, Val Acc: 79.99%, Best Val Acc: 79.99% (Epoch 4)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:38<00:00,  7.34it/s, loss=0.259, acc=92.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.76it/s]
Epoch 5/5 - Train Loss: 0.2594, Train Acc: 92.13%, Val Loss: 0.7259, Val Acc: 79.14%, Best Val Acc: 79.99% (Epoch 4)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  6.91it/s]
Skipping GradCAM visualization for frozen models

Fold 8 Evaluation:
Test Loss: 0.6807, Test Accuracy: 77.77%

================================================================================
Training on Fold 9
Train Folds: [1, 2, 3, 4, 5, 6, 7, 10]
Val Fold: [8]
Test Fold: [9]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:38<00:00,  7.36it/s, loss=0.781, acc=77]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:13<00:00,  6.84it/s]
Epoch 1/5 - Train Loss: 0.7813, Train Acc: 77.01%, Val Loss: 0.7661, Val Acc: 74.91%, Best Val Acc: 74.91% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:40<00:00,  7.27it/s, loss=0.416, acc=87.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:13<00:00,  6.78it/s]
Epoch 2/5 - Train Loss: 0.4158, Train Acc: 87.67%, Val Loss: 0.7365, Val Acc: 77.28%, Best Val Acc: 77.28% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:39<00:00,  7.29it/s, loss=0.336, acc=89.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:13<00:00,  6.74it/s]
Epoch 3/5 - Train Loss: 0.3358, Train Acc: 89.83%, Val Loss: 0.7516, Val Acc: 77.10%, Best Val Acc: 77.28% (Epoch 2)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:41<00:00,  7.20it/s, loss=0.294, acc=91.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:13<00:00,  6.84it/s]
Epoch 4/5 - Train Loss: 0.2937, Train Acc: 91.07%, Val Loss: 0.7349, Val Acc: 77.65%, Best Val Acc: 77.65% (Epoch 4)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:40<00:00,  7.24it/s, loss=0.265, acc=91.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:13<00:00,  6.76it/s]
Epoch 5/5 - Train Loss: 0.2646, Train Acc: 91.80%, Val Loss: 0.6983, Val Acc: 78.76%, Best Val Acc: 78.76% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:13<00:00,  6.75it/s]
Skipping GradCAM visualization for frozen models

Fold 9 Evaluation:
Test Loss: 0.5426, Test Accuracy: 86.06%

================================================================================
Training on Fold 10
Train Folds: [1, 2, 3, 4, 5, 6, 7, 8]
Val Fold: [9]
Test Fold: [10]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:39<00:00,  7.30it/s, loss=0.791, acc=76.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:13<00:00,  6.79it/s]
Epoch 1/5 - Train Loss: 0.7906, Train Acc: 76.73%, Val Loss: 0.6031, Val Acc: 83.04%, Best Val Acc: 83.04% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:38<00:00,  7.35it/s, loss=0.426, acc=87.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:13<00:00,  6.62it/s]
Epoch 2/5 - Train Loss: 0.4258, Train Acc: 87.23%, Val Loss: 0.6055, Val Acc: 81.84%, Best Val Acc: 83.04% (Epoch 1)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:39<00:00,  7.34it/s, loss=0.344, acc=89.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:13<00:00,  6.79it/s]
Epoch 3/5 - Train Loss: 0.3441, Train Acc: 89.59%, Val Loss: 0.5704, Val Acc: 83.76%, Best Val Acc: 83.76% (Epoch 3)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:40<00:00,  7.26it/s, loss=0.3, acc=90.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:13<00:00,  6.79it/s]
Epoch 4/5 - Train Loss: 0.2997, Train Acc: 90.92%, Val Loss: 0.5457, Val Acc: 84.21%, Best Val Acc: 84.21% (Epoch 4)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:40<00:00,  7.26it/s, loss=0.269, acc=91.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:13<00:00,  6.52it/s]
Epoch 5/5 - Train Loss: 0.2693, Train Acc: 91.69%, Val Loss: 0.5546, Val Acc: 83.32%, Best Val Acc: 84.21% (Epoch 4)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:13<00:00,  6.72it/s]
Skipping GradCAM visualization for frozen models

Fold 10 Evaluation:
Test Loss: 0.6126, Test Accuracy: 81.87%

================================================================================
Summary of results for convnext
================================================================================
Average Test Accuracy: 80.43%
Individual Fold Test Accuracies: [80.03798998445865, 78.09917355371901, 78.93470790378007, 84.85626283367556, 81.27130197682345, 77.17521880899262, 78.25717683030406, 77.76992401484361, 86.05794556628622, 81.86745934603952]
Summary saved to output/convnext/summary.json
Total execution time: 5766.74 seconds (1.60 hours)