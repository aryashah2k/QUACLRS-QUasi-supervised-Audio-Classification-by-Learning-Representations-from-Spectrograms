(base) jupyter-st125462@puffer:~/ExtendedUrbansound/output$ python train_kfold.py --model_name mobilenet --pretrained --batch_size 64 --epochs 5 --use_amp
python: can't open file '/home/jupyter-st125462/ExtendedUrbansound/output/train_kfold.py': [Errno 2] No such file or directory
(base) jupyter-st125462@puffer:~/ExtendedUrbansound/output$ cd ..
(base) jupyter-st125462@puffer:~/ExtendedUrbansound$ python train_kfold.py --model_name mobilenet --pretrained --batch_size 64 --epochs 5 --use_amp

================================================================================
Training on Fold 1
Train Folds: [2, 3, 4, 5, 6, 7, 8, 9]
Val Fold: [10]
Test Fold: [1]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                                                                                          | 0/726 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:39<00:00,  7.30it/s, loss=0.183, acc=94.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.35it/s]
Epoch 1/5 - Train Loss: 0.1833, Train Acc: 94.23%, Val Loss: 0.8889, Val Acc: 83.16%, Best Val Acc: 83.16% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:36<00:00,  7.55it/s, loss=0.0502, acc=98.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.07it/s]
Epoch 2/5 - Train Loss: 0.0502, Train Acc: 98.41%, Val Loss: 0.8785, Val Acc: 84.30%, Best Val Acc: 84.30% (Epoch 2)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:37<00:00,  7.45it/s, loss=0.0385, acc=98.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.04it/s]
Epoch 3/5 - Train Loss: 0.0385, Train Acc: 98.77%, Val Loss: 0.7784, Val Acc: 87.01%, Best Val Acc: 87.01% (Epoch 3)
Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:36<00:00,  7.51it/s, loss=0.0266, acc=99.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.33it/s]
Epoch 4/5 - Train Loss: 0.0266, Train Acc: 99.16%, Val Loss: 0.6788, Val Acc: 88.34%, Best Val Acc: 88.34% (Epoch 4)
Epoch 5: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:38<00:00,  7.39it/s, loss=0.0311, acc=99]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.11it/s]
Epoch 5/5 - Train Loss: 0.0311, Train Acc: 98.97%, Val Loss: 0.9304, Val Acc: 86.52%, Best Val Acc: 88.34% (Epoch 4)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.06it/s]

Fold 1 Evaluation:
Test Loss: 0.5101, Test Accuracy: 87.58%

================================================================================
Training on Fold 2
Train Folds: [3, 4, 5, 6, 7, 8, 9, 10]
Val Fold: [1]
Test Fold: [2]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                                                                                          | 0/724 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:39<00:00,  7.31it/s, loss=0.185, acc=94.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.04it/s]
Epoch 1/5 - Train Loss: 0.1851, Train Acc: 94.24%, Val Loss: 0.9692, Val Acc: 80.31%, Best Val Acc: 80.31% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:32<00:00,  7.86it/s, loss=0.0504, acc=98.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:11<00:00,  7.60it/s]
Epoch 2/5 - Train Loss: 0.0504, Train Acc: 98.37%, Val Loss: 1.5313, Val Acc: 81.30%, Best Val Acc: 81.30% (Epoch 2)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:32<00:00,  7.80it/s, loss=0.0342, acc=98.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.58it/s]
Epoch 3/5 - Train Loss: 0.0342, Train Acc: 98.91%, Val Loss: 0.9298, Val Acc: 82.66%, Best Val Acc: 82.66% (Epoch 3)
Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:33<00:00,  7.77it/s, loss=0.0263, acc=99.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.35it/s]
Epoch 4/5 - Train Loss: 0.0263, Train Acc: 99.18%, Val Loss: 0.8544, Val Acc: 80.11%, Best Val Acc: 82.66% (Epoch 3)
Epoch 5: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:32<00:00,  7.87it/s, loss=0.0324, acc=99]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:11<00:00,  7.58it/s]
Epoch 5/5 - Train Loss: 0.0324, Train Acc: 98.99%, Val Loss: 0.7241, Val Acc: 85.56%, Best Val Acc: 85.56% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.46it/s]

Fold 2 Evaluation:
Test Loss: 1.3716, Test Accuracy: 83.23%

================================================================================
Training on Fold 3
Train Folds: [1, 4, 5, 6, 7, 8, 9, 10]
Val Fold: [2]
Test Fold: [3]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                                                                                          | 0/724 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:35<00:00,  7.61it/s, loss=0.188, acc=94.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.05it/s]
Epoch 1/5 - Train Loss: 0.1876, Train Acc: 94.24%, Val Loss: 0.7446, Val Acc: 78.51%, Best Val Acc: 78.51% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:33<00:00,  7.76it/s, loss=0.0457, acc=98.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:11<00:00,  7.60it/s]
Epoch 2/5 - Train Loss: 0.0457, Train Acc: 98.59%, Val Loss: 0.9340, Val Acc: 78.20%, Best Val Acc: 78.51% (Epoch 1)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:33<00:00,  7.77it/s, loss=0.041, acc=98.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.58it/s]
Epoch 3/5 - Train Loss: 0.0410, Train Acc: 98.73%, Val Loss: 0.8356, Val Acc: 81.70%, Best Val Acc: 81.70% (Epoch 3)
Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:33<00:00,  7.76it/s, loss=0.0288, acc=99.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.41it/s]
Epoch 4/5 - Train Loss: 0.0288, Train Acc: 99.10%, Val Loss: 0.8190, Val Acc: 84.99%, Best Val Acc: 84.99% (Epoch 4)
Epoch 5: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:33<00:00,  7.76it/s, loss=0.0307, acc=99]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.15it/s]
Epoch 5/5 - Train Loss: 0.0307, Train Acc: 98.99%, Val Loss: 1.0096, Val Acc: 83.92%, Best Val Acc: 84.99% (Epoch 4)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.43it/s]

Fold 3 Evaluation:
Test Loss: 1.1481, Test Accuracy: 76.24%

================================================================================
Training on Fold 4
Train Folds: [1, 2, 5, 6, 7, 8, 9, 10]
Val Fold: [3]
Test Fold: [4]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                                                                                          | 0/723 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:36<00:00,  7.52it/s, loss=0.177, acc=94.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.35it/s]
Epoch 1/5 - Train Loss: 0.1766, Train Acc: 94.57%, Val Loss: 1.4601, Val Acc: 75.74%, Best Val Acc: 75.74% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:34<00:00,  7.64it/s, loss=0.0472, acc=98.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.37it/s]
Epoch 2/5 - Train Loss: 0.0472, Train Acc: 98.53%, Val Loss: 1.2448, Val Acc: 78.81%, Best Val Acc: 78.81% (Epoch 2)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:36<00:00,  7.48it/s, loss=0.0337, acc=98.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.33it/s]
Epoch 3/5 - Train Loss: 0.0337, Train Acc: 98.94%, Val Loss: 1.1594, Val Acc: 78.63%, Best Val Acc: 78.81% (Epoch 2)
Epoch 4: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:34<00:00,  7.65it/s, loss=0.0333, acc=99]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.26it/s]
Epoch 4/5 - Train Loss: 0.0333, Train Acc: 99.00%, Val Loss: 1.7070, Val Acc: 75.33%, Best Val Acc: 78.81% (Epoch 2)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:34<00:00,  7.69it/s, loss=0.0263, acc=99.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.38it/s]
Epoch 5/5 - Train Loss: 0.0263, Train Acc: 99.17%, Val Loss: 1.2618, Val Acc: 79.69%, Best Val Acc: 79.69% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.48it/s]

Fold 4 Evaluation:
Test Loss: 0.8019, Test Accuracy: 83.54%

================================================================================
Training on Fold 5
Train Folds: [1, 2, 3, 6, 7, 8, 9, 10]
Val Fold: [4]
Test Fold: [5]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                                                                                          | 0/722 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:35<00:00,  7.53it/s, loss=0.186, acc=94.3]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.33it/s]
Epoch 1/5 - Train Loss: 0.1862, Train Acc: 94.28%, Val Loss: 0.6223, Val Acc: 83.37%, Best Val Acc: 83.37% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:36<00:00,  7.45it/s, loss=0.0542, acc=98.3]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.46it/s]
Epoch 2/5 - Train Loss: 0.0542, Train Acc: 98.33%, Val Loss: 0.8770, Val Acc: 83.06%, Best Val Acc: 83.37% (Epoch 1)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:35<00:00,  7.58it/s, loss=0.0286, acc=99.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.25it/s]
Epoch 3/5 - Train Loss: 0.0286, Train Acc: 99.15%, Val Loss: 1.0907, Val Acc: 80.72%, Best Val Acc: 83.37% (Epoch 1)
Epoch 4: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:36<00:00,  7.50it/s, loss=0.0299, acc=99]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.30it/s]
Epoch 4/5 - Train Loss: 0.0299, Train Acc: 99.05%, Val Loss: 0.9509, Val Acc: 78.94%, Best Val Acc: 83.37% (Epoch 1)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:35<00:00,  7.57it/s, loss=0.0268, acc=99.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.23it/s]
Epoch 5/5 - Train Loss: 0.0268, Train Acc: 99.19%, Val Loss: 1.1810, Val Acc: 78.78%, Best Val Acc: 83.37% (Epoch 1)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.45it/s]

Fold 5 Evaluation:
Test Loss: 0.5867, Test Accuracy: 83.86%

================================================================================
Training on Fold 6
Train Folds: [1, 2, 3, 4, 7, 8, 9, 10]
Val Fold: [5]
Test Fold: [6]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                                                                                          | 0/723 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:36<00:00,  7.50it/s, loss=0.187, acc=94.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.39it/s]
Epoch 1/5 - Train Loss: 0.1871, Train Acc: 94.12%, Val Loss: 1.0157, Val Acc: 81.25%, Best Val Acc: 81.25% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:36<00:00,  7.53it/s, loss=0.0427, acc=98.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.41it/s]
Epoch 2/5 - Train Loss: 0.0427, Train Acc: 98.74%, Val Loss: 1.4481, Val Acc: 81.39%, Best Val Acc: 81.39% (Epoch 2)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:33<00:00,  7.71it/s, loss=0.0347, acc=98.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.35it/s]
Epoch 3/5 - Train Loss: 0.0347, Train Acc: 98.88%, Val Loss: 1.1635, Val Acc: 81.68%, Best Val Acc: 81.68% (Epoch 3)
Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:34<00:00,  7.68it/s, loss=0.0298, acc=99.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.31it/s]
Epoch 4/5 - Train Loss: 0.0298, Train Acc: 99.06%, Val Loss: 2.0580, Val Acc: 75.85%, Best Val Acc: 81.68% (Epoch 3)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:35<00:00,  7.55it/s, loss=0.0251, acc=99.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:11<00:00,  7.70it/s]
Epoch 5/5 - Train Loss: 0.0251, Train Acc: 99.19%, Val Loss: 1.6296, Val Acc: 77.81%, Best Val Acc: 81.68% (Epoch 3)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.58it/s]

Fold 6 Evaluation:
Test Loss: 1.4007, Test Accuracy: 75.12%

================================================================================
Training on Fold 7
Train Folds: [1, 2, 3, 4, 5, 8, 9, 10]
Val Fold: [6]
Test Fold: [7]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                                                                                          | 0/722 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:35<00:00,  7.55it/s, loss=0.19, acc=94]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.47it/s]
Epoch 1/5 - Train Loss: 0.1905, Train Acc: 93.99%, Val Loss: 0.7971, Val Acc: 78.39%, Best Val Acc: 78.39% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:34<00:00,  7.61it/s, loss=0.043, acc=98.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.33it/s]
Epoch 2/5 - Train Loss: 0.0430, Train Acc: 98.65%, Val Loss: 0.8766, Val Acc: 81.05%, Best Val Acc: 81.05% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:34<00:00,  7.67it/s, loss=0.041, acc=98.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.30it/s]
Epoch 3/5 - Train Loss: 0.0410, Train Acc: 98.70%, Val Loss: 0.9677, Val Acc: 78.75%, Best Val Acc: 81.05% (Epoch 2)
Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:35<00:00,  7.53it/s, loss=0.0262, acc=99.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.36it/s]
Epoch 4/5 - Train Loss: 0.0262, Train Acc: 99.14%, Val Loss: 1.3244, Val Acc: 75.67%, Best Val Acc: 81.05% (Epoch 2)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:35<00:00,  7.56it/s, loss=0.0277, acc=99.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.22it/s]
Epoch 5/5 - Train Loss: 0.0277, Train Acc: 99.18%, Val Loss: 0.9400, Val Acc: 83.58%, Best Val Acc: 83.58% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.53it/s]

Fold 7 Evaluation:
Test Loss: 0.7413, Test Accuracy: 86.04%

================================================================================
Training on Fold 8
Train Folds: [1, 2, 3, 4, 5, 6, 9, 10]
Val Fold: [7]
Test Fold: [8]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                                                                                          | 0/725 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:43<00:00,  7.02it/s, loss=0.182, acc=94.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.11it/s]
Epoch 1/5 - Train Loss: 0.1817, Train Acc: 94.39%, Val Loss: 0.5338, Val Acc: 86.95%, Best Val Acc: 86.95% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:37<00:00,  7.43it/s, loss=0.0437, acc=98.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.10it/s]
Epoch 2/5 - Train Loss: 0.0437, Train Acc: 98.64%, Val Loss: 0.8484, Val Acc: 81.43%, Best Val Acc: 86.95% (Epoch 1)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:38<00:00,  7.39it/s, loss=0.0345, acc=98.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.98it/s]
Epoch 3/5 - Train Loss: 0.0345, Train Acc: 98.93%, Val Loss: 0.5827, Val Acc: 89.54%, Best Val Acc: 89.54% (Epoch 3)
Epoch 4: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:38<00:00,  7.38it/s, loss=0.0328, acc=99]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.25it/s]
Epoch 4/5 - Train Loss: 0.0328, Train Acc: 98.98%, Val Loss: 0.9096, Val Acc: 83.42%, Best Val Acc: 89.54% (Epoch 3)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:37<00:00,  7.40it/s, loss=0.0255, acc=99.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.24it/s]
Epoch 5/5 - Train Loss: 0.0255, Train Acc: 99.24%, Val Loss: 0.8745, Val Acc: 85.49%, Best Val Acc: 89.54% (Epoch 3)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.27it/s]

Fold 8 Evaluation:
Test Loss: 0.8743, Test Accuracy: 81.13%

================================================================================
Training on Fold 9
Train Folds: [1, 2, 3, 4, 5, 6, 7, 10]
Val Fold: [8]
Test Fold: [9]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                                                                                          | 0/728 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:37<00:00,  7.45it/s, loss=0.182, acc=94.3]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.61it/s]
Epoch 1/5 - Train Loss: 0.1823, Train Acc: 94.29%, Val Loss: 1.0416, Val Acc: 72.65%, Best Val Acc: 72.65% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:37<00:00,  7.48it/s, loss=0.0521, acc=98.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.23it/s]
Epoch 2/5 - Train Loss: 0.0521, Train Acc: 98.39%, Val Loss: 0.9702, Val Acc: 79.57%, Best Val Acc: 79.57% (Epoch 2)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:37<00:00,  7.48it/s, loss=0.0358, acc=98.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.39it/s]
Epoch 3/5 - Train Loss: 0.0358, Train Acc: 98.91%, Val Loss: 1.2529, Val Acc: 78.02%, Best Val Acc: 79.57% (Epoch 2)
Epoch 4: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:37<00:00,  7.44it/s, loss=0.0334, acc=99]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.44it/s]
Epoch 4/5 - Train Loss: 0.0334, Train Acc: 99.02%, Val Loss: 1.0906, Val Acc: 81.37%, Best Val Acc: 81.37% (Epoch 4)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:36<00:00,  7.55it/s, loss=0.0248, acc=99.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.37it/s]
Epoch 5/5 - Train Loss: 0.0248, Train Acc: 99.23%, Val Loss: 1.0670, Val Acc: 79.18%, Best Val Acc: 81.37% (Epoch 4)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.09it/s]

Fold 9 Evaluation:
Test Loss: 0.7937, Test Accuracy: 86.02%

================================================================================
Training on Fold 10
Train Folds: [1, 2, 3, 4, 5, 6, 7, 8]
Val Fold: [9]
Test Fold: [10]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                                                                                          | 0/727 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:36<00:00,  7.52it/s, loss=0.185, acc=94.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  6.95it/s]
Epoch 1/5 - Train Loss: 0.1848, Train Acc: 94.20%, Val Loss: 0.8618, Val Acc: 84.53%, Best Val Acc: 84.53% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:37<00:00,  7.46it/s, loss=0.0492, acc=98.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.10it/s]
Epoch 2/5 - Train Loss: 0.0492, Train Acc: 98.47%, Val Loss: 0.6778, Val Acc: 85.18%, Best Val Acc: 85.18% (Epoch 2)
Epoch 3: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:35<00:00,  7.60it/s, loss=0.0308, acc=99]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.36it/s]
Epoch 3/5 - Train Loss: 0.0308, Train Acc: 99.04%, Val Loss: 0.7535, Val Acc: 90.52%, Best Val Acc: 90.52% (Epoch 3)
Epoch 4: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:34<00:00,  7.70it/s, loss=0.0327, acc=99]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.41it/s]
Epoch 4/5 - Train Loss: 0.0327, Train Acc: 98.99%, Val Loss: 0.9229, Val Acc: 86.69%, Best Val Acc: 90.52% (Epoch 3)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:34<00:00,  7.72it/s, loss=0.0261, acc=99.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.52it/s]
Epoch 5/5 - Train Loss: 0.0261, Train Acc: 99.19%, Val Loss: 1.0916, Val Acc: 86.15%, Best Val Acc: 90.52% (Epoch 3)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.44it/s]

Fold 10 Evaluation:
Test Loss: 0.7750, Test Accuracy: 87.25%

================================================================================
Summary of results for mobilenet
================================================================================
Average Test Accuracy: 83.00%
Individual Fold Test Accuracies: [87.5841823519254, 83.23002754820936, 76.23711340206185, 83.53867214236824, 83.86162235855487, 75.11584005491677, 86.0370307457109, 81.1274076691995, 86.02282704126426, 87.2530162615842]
Summary saved to output/mobilenet/summary.json
Total execution time: 5888.48 seconds (1.64 hours)