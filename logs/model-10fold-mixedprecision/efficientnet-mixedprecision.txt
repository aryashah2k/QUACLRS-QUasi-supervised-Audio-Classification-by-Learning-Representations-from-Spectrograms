(base) jupyter-st125462@puffer:~/ExtendedUrbansound$ python train_kfold.py --model_name efficientnet --pretrained --batch_size 64 --epochs 5 --use_amp

================================================================================
Training on Fold 1
Train Folds: [2, 3, 4, 5, 6, 7, 8, 9]
Val Fold: [10]
Test Fold: [1]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/726 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:38<00:00,  7.37it/s, loss=0.174, acc=94.7]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.03it/s]
Epoch 1/5 - Train Loss: 0.1738, Train Acc: 94.71%, Val Loss: 0.7662, Val Acc: 83.98%, Best Val Acc: 83.98% (Epoch 1)
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:40<00:00,  7.25it/s, loss=0.0437, acc=98.7]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.42it/s]
Epoch 2/5 - Train Loss: 0.0437, Train Acc: 98.67%, Val Loss: 1.0053, Val Acc: 85.71%, Best Val Acc: 85.71% (Epoch 2)
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:39<00:00,  7.31it/s, loss=0.0403, acc=98.7]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.18it/s]
Epoch 3/5 - Train Loss: 0.0403, Train Acc: 98.72%, Val Loss: 0.5786, Val Acc: 85.33%, Best Val Acc: 85.71% (Epoch 2)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:39<00:00,  7.27it/s, loss=0.0219, acc=99.3]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.42it/s]
Epoch 4/5 - Train Loss: 0.0219, Train Acc: 99.35%, Val Loss: 1.0036, Val Acc: 83.46%, Best Val Acc: 85.71% (Epoch 2)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:39<00:00,  7.29it/s, loss=0.021, acc=99.3]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.10it/s]
Epoch 5/5 - Train Loss: 0.0210, Train Acc: 99.31%, Val Loss: 1.1206, Val Acc: 83.27%, Best Val Acc: 85.71% (Epoch 2)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.50it/s]

Fold 1 Evaluation:
Test Loss: 0.6277, Test Accuracy: 81.11%

================================================================================
Training on Fold 2
Train Folds: [3, 4, 5, 6, 7, 8, 9, 10]
Val Fold: [1]
Test Fold: [2]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/724 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:38<00:00,  7.35it/s, loss=0.177, acc=94.5]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.32it/s]
Epoch 1/5 - Train Loss: 0.1770, Train Acc: 94.51%, Val Loss: 0.4850, Val Acc: 83.84%, Best Val Acc: 83.84% (Epoch 1)
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:37<00:00,  7.39it/s, loss=0.0433, acc=98.6]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.20it/s]
Epoch 2/5 - Train Loss: 0.0433, Train Acc: 98.65%, Val Loss: 0.5834, Val Acc: 85.34%, Best Val Acc: 85.34% (Epoch 2)
Epoch 3: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:38<00:00,  7.31it/s, loss=0.033, acc=99]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.17it/s]
Epoch 3/5 - Train Loss: 0.0330, Train Acc: 98.99%, Val Loss: 0.7564, Val Acc: 80.92%, Best Val Acc: 85.34% (Epoch 2)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:38<00:00,  7.36it/s, loss=0.0256, acc=99.2]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.28it/s]
Epoch 4/5 - Train Loss: 0.0256, Train Acc: 99.17%, Val Loss: 0.6481, Val Acc: 83.37%, Best Val Acc: 85.34% (Epoch 2)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:38<00:00,  7.38it/s, loss=0.0186, acc=99.4]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.36it/s]
Epoch 5/5 - Train Loss: 0.0186, Train Acc: 99.44%, Val Loss: 0.8153, Val Acc: 83.03%, Best Val Acc: 85.34% (Epoch 2)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.42it/s]

Fold 2 Evaluation:
Test Loss: 0.8657, Test Accuracy: 84.18%

================================================================================
Training on Fold 3
Train Folds: [1, 4, 5, 6, 7, 8, 9, 10]
Val Fold: [2]
Test Fold: [3]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/724 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:37<00:00,  7.44it/s, loss=0.175, acc=94.7]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.26it/s]
Epoch 1/5 - Train Loss: 0.1754, Train Acc: 94.70%, Val Loss: 0.8061, Val Acc: 83.94%, Best Val Acc: 83.94% (Epoch 1)
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:37<00:00,  7.42it/s, loss=0.0421, acc=98.7]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.34it/s]
Epoch 2/5 - Train Loss: 0.0421, Train Acc: 98.69%, Val Loss: 1.1764, Val Acc: 86.79%, Best Val Acc: 86.79% (Epoch 2)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:37<00:00,  7.41it/s, loss=0.035, acc=98.9]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.45it/s]
Epoch 3/5 - Train Loss: 0.0350, Train Acc: 98.87%, Val Loss: 1.0737, Val Acc: 81.03%, Best Val Acc: 86.79% (Epoch 2)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:37<00:00,  7.42it/s, loss=0.0251, acc=99.2]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.36it/s]
Epoch 4/5 - Train Loss: 0.0251, Train Acc: 99.25%, Val Loss: 0.9302, Val Acc: 81.04%, Best Val Acc: 86.79% (Epoch 2)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:36<00:00,  7.48it/s, loss=0.0252, acc=99.2]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.15it/s]
Epoch 5/5 - Train Loss: 0.0252, Train Acc: 99.25%, Val Loss: 1.2759, Val Acc: 81.56%, Best Val Acc: 86.79% (Epoch 2)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.39it/s]

Fold 3 Evaluation:
Test Loss: 1.0389, Test Accuracy: 80.93%

================================================================================
Training on Fold 4
Train Folds: [1, 2, 5, 6, 7, 8, 9, 10]
Val Fold: [3]
Test Fold: [4]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/723 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:38<00:00,  7.35it/s, loss=0.176, acc=94.4]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.26it/s]
Epoch 1/5 - Train Loss: 0.1761, Train Acc: 94.41%, Val Loss: 1.0765, Val Acc: 77.65%, Best Val Acc: 77.65% (Epoch 1)
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:38<00:00,  7.34it/s, loss=0.0415, acc=98.7]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.37it/s]
Epoch 2/5 - Train Loss: 0.0415, Train Acc: 98.68%, Val Loss: 1.4382, Val Acc: 82.34%, Best Val Acc: 82.34% (Epoch 2)
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:38<00:00,  7.38it/s, loss=0.0308, acc=99.1]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.25it/s]
Epoch 3/5 - Train Loss: 0.0308, Train Acc: 99.09%, Val Loss: 0.7313, Val Acc: 81.82%, Best Val Acc: 82.34% (Epoch 2)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:37<00:00,  7.38it/s, loss=0.0281, acc=99.2]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.15it/s]
Epoch 4/5 - Train Loss: 0.0281, Train Acc: 99.17%, Val Loss: 1.2209, Val Acc: 82.51%, Best Val Acc: 82.51% (Epoch 4)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:38<00:00,  7.33it/s, loss=0.0233, acc=99.3]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.35it/s]
Epoch 5/5 - Train Loss: 0.0233, Train Acc: 99.30%, Val Loss: 1.3309, Val Acc: 80.67%, Best Val Acc: 82.51% (Epoch 4)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.22it/s]

Fold 4 Evaluation:
Test Loss: 1.0444, Test Accuracy: 83.09%

================================================================================
Training on Fold 5
Train Folds: [1, 2, 3, 6, 7, 8, 9, 10]
Val Fold: [4]
Test Fold: [5]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/722 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:39<00:00,  7.23it/s, loss=0.174, acc=94.6]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.21it/s]
Epoch 1/5 - Train Loss: 0.1736, Train Acc: 94.55%, Val Loss: 0.8868, Val Acc: 79.95%, Best Val Acc: 79.95% (Epoch 1)
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:37<00:00,  7.40it/s, loss=0.0435, acc=98.7]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.25it/s]
Epoch 2/5 - Train Loss: 0.0435, Train Acc: 98.68%, Val Loss: 1.0247, Val Acc: 79.16%, Best Val Acc: 79.95% (Epoch 1)
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:37<00:00,  7.37it/s, loss=0.0362, acc=98.9]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.31it/s]
Epoch 3/5 - Train Loss: 0.0362, Train Acc: 98.87%, Val Loss: 1.0253, Val Acc: 79.65%, Best Val Acc: 79.95% (Epoch 1)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:38<00:00,  7.36it/s, loss=0.0248, acc=99.2]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.28it/s]
Epoch 4/5 - Train Loss: 0.0248, Train Acc: 99.24%, Val Loss: 0.7883, Val Acc: 84.12%, Best Val Acc: 84.12% (Epoch 4)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:38<00:00,  7.34it/s, loss=0.0217, acc=99.4]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.23it/s]
Epoch 5/5 - Train Loss: 0.0217, Train Acc: 99.36%, Val Loss: 1.1212, Val Acc: 81.35%, Best Val Acc: 84.12% (Epoch 4)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.11it/s]

Fold 5 Evaluation:
Test Loss: 1.4694, Test Accuracy: 80.59%

================================================================================
Training on Fold 6
Train Folds: [1, 2, 3, 4, 7, 8, 9, 10]
Val Fold: [5]
Test Fold: [6]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/723 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:37<00:00,  7.42it/s, loss=0.174, acc=94.6]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.46it/s]
Epoch 1/5 - Train Loss: 0.1738, Train Acc: 94.60%, Val Loss: 0.9775, Val Acc: 80.15%, Best Val Acc: 80.15% (Epoch 1)
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:38<00:00,  7.37it/s, loss=0.0424, acc=98.7]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.17it/s]
Epoch 2/5 - Train Loss: 0.0424, Train Acc: 98.65%, Val Loss: 1.2268, Val Acc: 81.49%, Best Val Acc: 81.49% (Epoch 2)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:39<00:00,  7.29it/s, loss=0.028, acc=99.2]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.33it/s]
Epoch 3/5 - Train Loss: 0.0280, Train Acc: 99.18%, Val Loss: 0.9179, Val Acc: 83.27%, Best Val Acc: 83.27% (Epoch 3)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:39<00:00,  7.29it/s, loss=0.0306, acc=99.1]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.16it/s]
Epoch 4/5 - Train Loss: 0.0306, Train Acc: 99.08%, Val Loss: 1.4900, Val Acc: 77.35%, Best Val Acc: 83.27% (Epoch 3)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:38<00:00,  7.31it/s, loss=0.0206, acc=99.4]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.28it/s]
Epoch 5/5 - Train Loss: 0.0206, Train Acc: 99.38%, Val Loss: 1.6476, Val Acc: 80.15%, Best Val Acc: 83.27% (Epoch 3)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.21it/s]

Fold 6 Evaluation:
Test Loss: 1.5378, Test Accuracy: 75.60%

================================================================================
Training on Fold 7
Train Folds: [1, 2, 3, 4, 5, 8, 9, 10]
Val Fold: [6]
Test Fold: [7]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/722 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:39<00:00,  7.27it/s, loss=0.167, acc=94.9]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.25it/s]
Epoch 1/5 - Train Loss: 0.1667, Train Acc: 94.88%, Val Loss: 1.0826, Val Acc: 76.40%, Best Val Acc: 76.40% (Epoch 1)
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:38<00:00,  7.33it/s, loss=0.0412, acc=98.7]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.20it/s]
Epoch 2/5 - Train Loss: 0.0412, Train Acc: 98.66%, Val Loss: 0.7440, Val Acc: 81.79%, Best Val Acc: 81.79% (Epoch 2)
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:38<00:00,  7.34it/s, loss=0.0298, acc=99.1]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.18it/s]
Epoch 3/5 - Train Loss: 0.0298, Train Acc: 99.07%, Val Loss: 0.9949, Val Acc: 82.60%, Best Val Acc: 82.60% (Epoch 3)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:38<00:00,  7.30it/s, loss=0.0257, acc=99.2]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.21it/s]
Epoch 4/5 - Train Loss: 0.0257, Train Acc: 99.21%, Val Loss: 1.1000, Val Acc: 80.44%, Best Val Acc: 82.60% (Epoch 3)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:38<00:00,  7.35it/s, loss=0.0251, acc=99.2]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.33it/s]
Epoch 5/5 - Train Loss: 0.0251, Train Acc: 99.23%, Val Loss: 1.2486, Val Acc: 81.00%, Best Val Acc: 82.60% (Epoch 3)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.10it/s]

Fold 7 Evaluation:
Test Loss: 0.9833, Test Accuracy: 84.46%

================================================================================
Training on Fold 8
Train Folds: [1, 2, 3, 4, 5, 6, 9, 10]
Val Fold: [7]
Test Fold: [8]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/725 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:38<00:00,  7.34it/s, loss=0.178, acc=94.5]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.23it/s]
Epoch 1/5 - Train Loss: 0.1779, Train Acc: 94.53%, Val Loss: 1.1119, Val Acc: 83.73%, Best Val Acc: 83.73% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:38<00:00,  7.36it/s, loss=0.045, acc=98.6]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.28it/s]
Epoch 2/5 - Train Loss: 0.0450, Train Acc: 98.62%, Val Loss: 0.7119, Val Acc: 86.80%, Best Val Acc: 86.80% (Epoch 2)
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:38<00:00,  7.33it/s, loss=0.0296, acc=99.1]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  7.07it/s]
Epoch 3/5 - Train Loss: 0.0296, Train Acc: 99.12%, Val Loss: 1.1529, Val Acc: 85.70%, Best Val Acc: 86.80% (Epoch 2)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:37<00:00,  7.45it/s, loss=0.0259, acc=99.2]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.37it/s]
Epoch 4/5 - Train Loss: 0.0259, Train Acc: 99.22%, Val Loss: 0.6440, Val Acc: 86.61%, Best Val Acc: 86.80% (Epoch 2)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:38<00:00,  7.38it/s, loss=0.0236, acc=99.3]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.20it/s]
Epoch 5/5 - Train Loss: 0.0236, Train Acc: 99.29%, Val Loss: 0.7886, Val Acc: 85.24%, Best Val Acc: 86.80% (Epoch 2)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.28it/s]

Fold 8 Evaluation:
Test Loss: 1.1587, Test Accuracy: 78.03%

================================================================================
Training on Fold 9
Train Folds: [1, 2, 3, 4, 5, 6, 7, 10]
Val Fold: [8]
Test Fold: [9]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/728 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:38<00:00,  7.38it/s, loss=0.174, acc=94.7]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.32it/s]
Epoch 1/5 - Train Loss: 0.1740, Train Acc: 94.71%, Val Loss: 0.7475, Val Acc: 80.65%, Best Val Acc: 80.65% (Epoch 1)
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:38<00:00,  7.37it/s, loss=0.0456, acc=98.6]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.32it/s]
Epoch 2/5 - Train Loss: 0.0456, Train Acc: 98.64%, Val Loss: 0.9993, Val Acc: 81.36%, Best Val Acc: 81.36% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:39<00:00,  7.30it/s, loss=0.0314, acc=99]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.23it/s]
Epoch 3/5 - Train Loss: 0.0314, Train Acc: 99.01%, Val Loss: 0.8853, Val Acc: 81.59%, Best Val Acc: 81.59% (Epoch 3)
Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:38<00:00,  7.35it/s, loss=0.029, acc=99.1]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.11it/s]
Epoch 4/5 - Train Loss: 0.0290, Train Acc: 99.07%, Val Loss: 0.9724, Val Acc: 79.15%, Best Val Acc: 81.59% (Epoch 3)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:39<00:00,  7.34it/s, loss=0.0232, acc=99.3]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.47it/s]
Epoch 5/5 - Train Loss: 0.0232, Train Acc: 99.30%, Val Loss: 0.8324, Val Acc: 81.29%, Best Val Acc: 81.59% (Epoch 3)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.03it/s]

Fold 9 Evaluation:
Test Loss: 0.7642, Test Accuracy: 83.23%

================================================================================
Training on Fold 10
Train Folds: [1, 2, 3, 4, 5, 6, 7, 8]
Val Fold: [9]
Test Fold: [10]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/727 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:38<00:00,  7.38it/s, loss=0.172, acc=94.6]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.27it/s]
Epoch 1/5 - Train Loss: 0.1724, Train Acc: 94.59%, Val Loss: 0.4904, Val Acc: 92.10%, Best Val Acc: 92.10% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:37<00:00,  7.43it/s, loss=0.048, acc=98.5]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.29it/s]
Epoch 2/5 - Train Loss: 0.0480, Train Acc: 98.53%, Val Loss: 0.7080, Val Acc: 87.04%, Best Val Acc: 92.10% (Epoch 1)
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:38<00:00,  7.37it/s, loss=0.0345, acc=98.9]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.34it/s]
Epoch 3/5 - Train Loss: 0.0345, Train Acc: 98.94%, Val Loss: 0.7125, Val Acc: 87.73%, Best Val Acc: 92.10% (Epoch 1)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:39<00:00,  7.34it/s, loss=0.0256, acc=99.2]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.15it/s]
Epoch 4/5 - Train Loss: 0.0256, Train Acc: 99.20%, Val Loss: 0.5604, Val Acc: 89.78%, Best Val Acc: 92.10% (Epoch 1)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:37<00:00,  7.43it/s, loss=0.0214, acc=99.4]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  6.92it/s]
Epoch 5/5 - Train Loss: 0.0214, Train Acc: 99.39%, Val Loss: 0.8170, Val Acc: 84.71%, Best Val Acc: 92.10% (Epoch 1)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.14it/s]

Fold 10 Evaluation:
Test Loss: 0.8614, Test Accuracy: 84.04%

================================================================================
Summary of results for efficientnet
================================================================================
Average Test Accuracy: 81.53%
Individual Fold Test Accuracies: [81.10861681920221, 84.17699724517907, 80.9278350515464, 83.09377138945928, 80.58963871847307, 75.59636176420113, 84.45727874978766, 78.03498851387171, 83.23090430201931, 84.03567057177828]
Summary saved to output/efficientnet/summary.json
Total execution time: 6050.61 seconds (1.68 hours)