(base) jupyter-st125462@puffer:~/ExtendedUrbansound$ python train_kfold.py --model_name resnet18 --pretrained --batch_size 64 --epochs 5 --use_amp

================================================================================
Training on Fold 1
Train Folds: [2, 3, 4, 5, 6, 7, 8, 9]
Val Fold: [10]
Test Fold: [1]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                      | 0/726 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:39<00:00,  7.28it/s, loss=0.197, acc=93.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.42it/s]
Epoch 1/5 - Train Loss: 0.1965, Train Acc: 93.59%, Val Loss: 0.4698, Val Acc: 86.62%, Best Val Acc: 86.62% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:31<00:00,  7.92it/s, loss=0.0503, acc=98.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.47it/s]
Epoch 2/5 - Train Loss: 0.0503, Train Acc: 98.42%, Val Loss: 0.8864, Val Acc: 82.76%, Best Val Acc: 86.62% (Epoch 1)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:29<00:00,  8.12it/s, loss=0.0378, acc=98.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.44it/s]
Epoch 3/5 - Train Loss: 0.0378, Train Acc: 98.76%, Val Loss: 1.2253, Val Acc: 73.82%, Best Val Acc: 86.62% (Epoch 1)
Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:30<00:00,  8.06it/s, loss=0.0297, acc=99.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:11<00:00,  7.71it/s]
Epoch 4/5 - Train Loss: 0.0297, Train Acc: 99.10%, Val Loss: 1.0778, Val Acc: 82.32%, Best Val Acc: 86.62% (Epoch 1)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:32<00:00,  7.82it/s, loss=0.0233, acc=99.3]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:11<00:00,  7.63it/s]
Epoch 5/5 - Train Loss: 0.0233, Train Acc: 99.32%, Val Loss: 0.7632, Val Acc: 82.62%, Best Val Acc: 86.62% (Epoch 1)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.40it/s]

Fold 1 Evaluation:
Test Loss: 0.6807, Test Accuracy: 82.97%

================================================================================
Training on Fold 2
Train Folds: [3, 4, 5, 6, 7, 8, 9, 10]
Val Fold: [1]
Test Fold: [2]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                      | 0/724 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:36<00:00,  7.51it/s, loss=0.182, acc=94.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.17it/s]
Epoch 1/5 - Train Loss: 0.1820, Train Acc: 94.17%, Val Loss: 0.9885, Val Acc: 75.91%, Best Val Acc: 75.91% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:32<00:00,  7.80it/s, loss=0.0457, acc=98.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.37it/s]
Epoch 2/5 - Train Loss: 0.0457, Train Acc: 98.58%, Val Loss: 0.9129, Val Acc: 80.50%, Best Val Acc: 80.50% (Epoch 2)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:32<00:00,  7.80it/s, loss=0.0429, acc=98.6]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.37it/s]
Epoch 3/5 - Train Loss: 0.0429, Train Acc: 98.63%, Val Loss: 0.5410, Val Acc: 84.60%, Best Val Acc: 84.60% (Epoch 3)
Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:31<00:00,  7.87it/s, loss=0.0226, acc=99.3]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.49it/s]
Epoch 4/5 - Train Loss: 0.0226, Train Acc: 99.34%, Val Loss: 1.1895, Val Acc: 78.10%, Best Val Acc: 84.60% (Epoch 3)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:32<00:00,  7.84it/s, loss=0.0248, acc=99.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.36it/s]
Epoch 5/5 - Train Loss: 0.0248, Train Acc: 99.21%, Val Loss: 1.0601, Val Acc: 78.47%, Best Val Acc: 84.60% (Epoch 3)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.47it/s]

Fold 2 Evaluation:
Test Loss: 0.8393, Test Accuracy: 85.88%

================================================================================
Training on Fold 3
Train Folds: [1, 4, 5, 6, 7, 8, 9, 10]
Val Fold: [2]
Test Fold: [3]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                      | 0/724 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:32<00:00,  7.82it/s, loss=0.184, acc=94.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.32it/s]
Epoch 1/5 - Train Loss: 0.1842, Train Acc: 94.11%, Val Loss: 0.7816, Val Acc: 80.29%, Best Val Acc: 80.29% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:31<00:00,  7.92it/s, loss=0.0514, acc=98.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.45it/s]
Epoch 2/5 - Train Loss: 0.0514, Train Acc: 98.35%, Val Loss: 1.3283, Val Acc: 76.07%, Best Val Acc: 80.29% (Epoch 1)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:31<00:00,  7.92it/s, loss=0.036, acc=98.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.44it/s]
Epoch 3/5 - Train Loss: 0.0360, Train Acc: 98.81%, Val Loss: 0.9955, Val Acc: 81.01%, Best Val Acc: 81.01% (Epoch 3)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:31<00:00,  7.87it/s, loss=0.033, acc=99]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.44it/s]
Epoch 4/5 - Train Loss: 0.0330, Train Acc: 98.99%, Val Loss: 0.8819, Val Acc: 84.16%, Best Val Acc: 84.16% (Epoch 4)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:31<00:00,  7.87it/s, loss=0.0294, acc=99.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.37it/s]
Epoch 5/5 - Train Loss: 0.0294, Train Acc: 99.11%, Val Loss: 0.9645, Val Acc: 75.76%, Best Val Acc: 84.16% (Epoch 4)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:11<00:00,  7.61it/s]

Fold 3 Evaluation:
Test Loss: 1.1586, Test Accuracy: 76.20%

================================================================================
Training on Fold 4
Train Folds: [1, 2, 5, 6, 7, 8, 9, 10]
Val Fold: [3]
Test Fold: [4]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                      | 0/723 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:30<00:00,  8.02it/s, loss=0.192, acc=93.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:11<00:00,  7.60it/s]
Epoch 1/5 - Train Loss: 0.1921, Train Acc: 93.78%, Val Loss: 1.8009, Val Acc: 70.65%, Best Val Acc: 70.65% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:30<00:00,  8.01it/s, loss=0.0568, acc=98.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.38it/s]
Epoch 2/5 - Train Loss: 0.0568, Train Acc: 98.13%, Val Loss: 1.5183, Val Acc: 72.25%, Best Val Acc: 72.25% (Epoch 2)
Epoch 3: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:31<00:00,  7.91it/s, loss=0.0314, acc=99]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.23it/s]
Epoch 3/5 - Train Loss: 0.0314, Train Acc: 98.96%, Val Loss: 1.2430, Val Acc: 75.05%, Best Val Acc: 75.05% (Epoch 3)
Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:30<00:00,  7.99it/s, loss=0.0344, acc=98.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.40it/s]
Epoch 4/5 - Train Loss: 0.0344, Train Acc: 98.87%, Val Loss: 1.3725, Val Acc: 75.21%, Best Val Acc: 75.21% (Epoch 4)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:30<00:00,  7.95it/s, loss=0.0282, acc=99.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.53it/s]
Epoch 5/5 - Train Loss: 0.0282, Train Acc: 99.10%, Val Loss: 1.1843, Val Acc: 79.59%, Best Val Acc: 79.59% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.42it/s]

Fold 4 Evaluation:
Test Loss: 1.4695, Test Accuracy: 75.31%

================================================================================
Training on Fold 5
Train Folds: [1, 2, 3, 6, 7, 8, 9, 10]
Val Fold: [4]
Test Fold: [5]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                      | 0/722 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:30<00:00,  8.01it/s, loss=0.181, acc=94.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.56it/s]
Epoch 1/5 - Train Loss: 0.1813, Train Acc: 94.13%, Val Loss: 0.9581, Val Acc: 80.18%, Best Val Acc: 80.18% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:31<00:00,  7.90it/s, loss=0.0532, acc=98.3]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.64it/s]
Epoch 2/5 - Train Loss: 0.0532, Train Acc: 98.31%, Val Loss: 1.6620, Val Acc: 71.15%, Best Val Acc: 80.18% (Epoch 1)
Epoch 3: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:30<00:00,  7.97it/s, loss=0.0319, acc=99]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.48it/s]
Epoch 3/5 - Train Loss: 0.0319, Train Acc: 98.99%, Val Loss: 1.0940, Val Acc: 79.69%, Best Val Acc: 80.18% (Epoch 1)
Epoch 4: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:37<00:00,  7.43it/s, loss=0.0335, acc=99]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.11it/s]
Epoch 4/5 - Train Loss: 0.0335, Train Acc: 98.98%, Val Loss: 1.1107, Val Acc: 80.82%, Best Val Acc: 80.82% (Epoch 4)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:36<00:00,  7.49it/s, loss=0.0235, acc=99.3]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.19it/s]
Epoch 5/5 - Train Loss: 0.0235, Train Acc: 99.33%, Val Loss: 1.0862, Val Acc: 81.69%, Best Val Acc: 81.69% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.18it/s]

Fold 5 Evaluation:
Test Loss: 1.0652, Test Accuracy: 76.55%

================================================================================
Training on Fold 6
Train Folds: [1, 2, 3, 4, 7, 8, 9, 10]
Val Fold: [5]
Test Fold: [6]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                      | 0/723 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:35<00:00,  7.54it/s, loss=0.19, acc=93.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.14it/s]
Epoch 1/5 - Train Loss: 0.1897, Train Acc: 93.94%, Val Loss: 1.4743, Val Acc: 71.01%, Best Val Acc: 71.01% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:32<00:00,  7.79it/s, loss=0.0513, acc=98.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.38it/s]
Epoch 2/5 - Train Loss: 0.0513, Train Acc: 98.43%, Val Loss: 0.8892, Val Acc: 78.66%, Best Val Acc: 78.66% (Epoch 2)
Epoch 3: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:32<00:00,  7.82it/s, loss=0.0321, acc=99]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.45it/s]
Epoch 3/5 - Train Loss: 0.0321, Train Acc: 98.96%, Val Loss: 1.7438, Val Acc: 76.53%, Best Val Acc: 78.66% (Epoch 2)
Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:32<00:00,  7.78it/s, loss=0.0352, acc=98.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.25it/s]
Epoch 4/5 - Train Loss: 0.0352, Train Acc: 98.87%, Val Loss: 1.8453, Val Acc: 78.03%, Best Val Acc: 78.66% (Epoch 2)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:32<00:00,  7.79it/s, loss=0.0202, acc=99.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.16it/s]
Epoch 5/5 - Train Loss: 0.0202, Train Acc: 99.41%, Val Loss: 1.1048, Val Acc: 80.30%, Best Val Acc: 80.30% (Epoch 5)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.57it/s]

Fold 6 Evaluation:
Test Loss: 0.9413, Test Accuracy: 78.79%

================================================================================
Training on Fold 7
Train Folds: [1, 2, 3, 4, 5, 8, 9, 10]
Val Fold: [6]
Test Fold: [7]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                      | 0/722 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:40<00:00,  7.17it/s, loss=0.189, acc=93.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.77it/s]
Epoch 1/5 - Train Loss: 0.1887, Train Acc: 93.93%, Val Loss: 0.9564, Val Acc: 75.70%, Best Val Acc: 75.70% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:38<00:00,  7.33it/s, loss=0.0511, acc=98.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.12it/s]
Epoch 2/5 - Train Loss: 0.0511, Train Acc: 98.44%, Val Loss: 1.1247, Val Acc: 78.99%, Best Val Acc: 78.99% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:39<00:00,  7.24it/s, loss=0.038, acc=98.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  7.03it/s]
Epoch 3/5 - Train Loss: 0.0380, Train Acc: 98.83%, Val Loss: 1.2889, Val Acc: 73.98%, Best Val Acc: 78.99% (Epoch 2)
Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:39<00:00,  7.28it/s, loss=0.0267, acc=99.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.76it/s]
Epoch 4/5 - Train Loss: 0.0267, Train Acc: 99.13%, Val Loss: 1.4931, Val Acc: 76.20%, Best Val Acc: 78.99% (Epoch 2)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:40<00:00,  7.21it/s, loss=0.0213, acc=99.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.10it/s]
Epoch 5/5 - Train Loss: 0.0213, Train Acc: 99.37%, Val Loss: 1.2843, Val Acc: 77.83%, Best Val Acc: 78.99% (Epoch 2)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.89it/s]

Fold 7 Evaluation:
Test Loss: 1.2487, Test Accuracy: 81.42%

================================================================================
Training on Fold 8
Train Folds: [1, 2, 3, 4, 5, 6, 9, 10]
Val Fold: [7]
Test Fold: [8]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                      | 0/725 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:38<00:00,  7.34it/s, loss=0.176, acc=94.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.25it/s]
Epoch 1/5 - Train Loss: 0.1764, Train Acc: 94.37%, Val Loss: 0.8823, Val Acc: 74.10%, Best Val Acc: 74.10% (Epoch 1)
Epoch 2: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:38<00:00,  7.39it/s, loss=0.05, acc=98.4]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.96it/s]
Epoch 2/5 - Train Loss: 0.0500, Train Acc: 98.39%, Val Loss: 1.4446, Val Acc: 76.42%, Best Val Acc: 76.42% (Epoch 2)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:35<00:00,  7.55it/s, loss=0.0411, acc=98.7]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.33it/s]
Epoch 3/5 - Train Loss: 0.0411, Train Acc: 98.71%, Val Loss: 1.1111, Val Acc: 82.47%, Best Val Acc: 82.47% (Epoch 3)
Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:33<00:00,  7.75it/s, loss=0.0295, acc=99.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.40it/s]
Epoch 4/5 - Train Loss: 0.0295, Train Acc: 99.14%, Val Loss: 0.9321, Val Acc: 80.91%, Best Val Acc: 82.47% (Epoch 3)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:30<00:00,  7.99it/s, loss=0.0264, acc=99.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.21it/s]
Epoch 5/5 - Train Loss: 0.0264, Train Acc: 99.19%, Val Loss: 1.1469, Val Acc: 82.33%, Best Val Acc: 82.47% (Epoch 3)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.68it/s]

Fold 8 Evaluation:
Test Loss: 0.9863, Test Accuracy: 79.43%

================================================================================
Training on Fold 9
Train Folds: [1, 2, 3, 4, 5, 6, 7, 10]
Val Fold: [8]
Test Fold: [9]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                      | 0/728 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:31<00:00,  7.99it/s, loss=0.186, acc=94.1]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.67it/s]
Epoch 1/5 - Train Loss: 0.1862, Train Acc: 94.05%, Val Loss: 0.9463, Val Acc: 73.83%, Best Val Acc: 73.83% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:30<00:00,  8.06it/s, loss=0.0503, acc=98.5]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.64it/s]
Epoch 2/5 - Train Loss: 0.0503, Train Acc: 98.47%, Val Loss: 1.0967, Val Acc: 77.38%, Best Val Acc: 77.38% (Epoch 2)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:31<00:00,  7.98it/s, loss=0.0354, acc=98.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.49it/s]
Epoch 3/5 - Train Loss: 0.0354, Train Acc: 98.90%, Val Loss: 1.3258, Val Acc: 78.12%, Best Val Acc: 78.12% (Epoch 3)
Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:31<00:00,  7.95it/s, loss=0.0337, acc=98.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.47it/s]
Epoch 4/5 - Train Loss: 0.0337, Train Acc: 98.92%, Val Loss: 0.7891, Val Acc: 85.14%, Best Val Acc: 85.14% (Epoch 4)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:30<00:00,  8.02it/s, loss=0.025, acc=99.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.59it/s]
Epoch 5/5 - Train Loss: 0.0250, Train Acc: 99.20%, Val Loss: 1.0727, Val Acc: 76.36%, Best Val Acc: 85.14% (Epoch 4)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.63it/s]

Fold 9 Evaluation:
Test Loss: 0.6696, Test Accuracy: 86.41%

================================================================================
Training on Fold 10
Train Folds: [1, 2, 3, 4, 5, 6, 7, 8]
Val Fold: [9]
Test Fold: [10]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                      | 0/727 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:31<00:00,  7.98it/s, loss=0.193, acc=93.8]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.57it/s]
Epoch 1/5 - Train Loss: 0.1927, Train Acc: 93.81%, Val Loss: 0.9276, Val Acc: 82.97%, Best Val Acc: 82.97% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:31<00:00,  7.91it/s, loss=0.0533, acc=98.3]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.38it/s]
Epoch 2/5 - Train Loss: 0.0533, Train Acc: 98.35%, Val Loss: 0.8883, Val Acc: 84.81%, Best Val Acc: 84.81% (Epoch 2)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:32<00:00,  7.89it/s, loss=0.036, acc=98.9]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.42it/s]
Epoch 3/5 - Train Loss: 0.0360, Train Acc: 98.89%, Val Loss: 1.4383, Val Acc: 80.61%, Best Val Acc: 84.81% (Epoch 2)
Epoch 4: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:32<00:00,  7.83it/s, loss=0.0313, acc=99]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.25it/s]
Epoch 4/5 - Train Loss: 0.0313, Train Acc: 99.05%, Val Loss: 0.8841, Val Acc: 83.97%, Best Val Acc: 84.81% (Epoch 2)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:32<00:00,  7.89it/s, loss=0.0293, acc=99.2]
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.46it/s]
Epoch 5/5 - Train Loss: 0.0293, Train Acc: 99.16%, Val Loss: 0.9084, Val Acc: 82.79%, Best Val Acc: 84.81% (Epoch 2)
Validating: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.32it/s]

Fold 10 Evaluation:
Test Loss: 1.0763, Test Accuracy: 80.42%

================================================================================
Summary of results for resnet18
================================================================================
Average Test Accuracy: 80.34%
Individual Fold Test Accuracies: [82.97357969262649, 85.88154269972452, 76.20274914089347, 75.30800821355236, 76.55078391274711, 78.7883988330187, 81.4166808221505, 79.43099487541969, 86.40913081650571, 80.41615667074663]
Summary saved to output/resnet18/summary.json
Total execution time: 5770.02 seconds (1.60 hours)