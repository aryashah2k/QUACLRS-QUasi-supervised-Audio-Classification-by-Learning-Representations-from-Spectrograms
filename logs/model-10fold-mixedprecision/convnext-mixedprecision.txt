(base) jupyter-st125462@puffer:~/ExtendedUrbansound$ python train_kfold.py --model_name convnext --pretrained --batch_size 64 --epochs 5 --use_amp

================================================================================
Training on Fold 1
Train Folds: [2, 3, 4, 5, 6, 7, 8, 9]
Val Fold: [10]
Test Fold: [1]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/726 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:44<00:00,  6.93it/s, loss=0.239, acc=92.2]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.06it/s]
Epoch 1/5 - Train Loss: 0.2394, Train Acc: 92.18%, Val Loss: 0.7491, Val Acc: 78.69%, Best Val Acc: 78.69% (Epoch 1)
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:42<00:00,  7.08it/s, loss=0.0652, acc=97.9]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.12it/s]
Epoch 2/5 - Train Loss: 0.0652, Train Acc: 97.94%, Val Loss: 0.6513, Val Acc: 85.73%, Best Val Acc: 85.73% (Epoch 2)
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:43<00:00,  7.03it/s, loss=0.0393, acc=98.8]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.14it/s]
Epoch 3/5 - Train Loss: 0.0393, Train Acc: 98.84%, Val Loss: 0.8138, Val Acc: 83.25%, Best Val Acc: 85.73% (Epoch 2)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:42<00:00,  7.09it/s, loss=0.0331, acc=99]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.26it/s]
Epoch 4/5 - Train Loss: 0.0331, Train Acc: 98.99%, Val Loss: 0.7296, Val Acc: 85.77%, Best Val Acc: 85.77% (Epoch 4)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:42<00:00,  7.06it/s, loss=0.0373, acc=98.8]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.11it/s]
Epoch 5/5 - Train Loss: 0.0373, Train Acc: 98.82%, Val Loss: 0.6819, Val Acc: 85.28%, Best Val Acc: 85.77% (Epoch 4)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.14it/s]

Fold 1 Evaluation:
Test Loss: 1.1795, Test Accuracy: 81.06%

================================================================================
Training on Fold 2
Train Folds: [3, 4, 5, 6, 7, 8, 9, 10]
Val Fold: [1]
Test Fold: [2]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/724 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:42<00:00,  7.05it/s, loss=0.26, acc=91.5]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.02it/s]
Epoch 1/5 - Train Loss: 0.2601, Train Acc: 91.47%, Val Loss: 0.9292, Val Acc: 77.02%, Best Val Acc: 77.02% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:42<00:00,  7.05it/s, loss=0.0628, acc=98]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.22it/s]
Epoch 2/5 - Train Loss: 0.0628, Train Acc: 98.00%, Val Loss: 1.0988, Val Acc: 80.54%, Best Val Acc: 80.54% (Epoch 2)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:42<00:00,  7.05it/s, loss=0.043, acc=98.6]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.12it/s]
Epoch 3/5 - Train Loss: 0.0430, Train Acc: 98.63%, Val Loss: 1.2760, Val Acc: 74.75%, Best Val Acc: 80.54% (Epoch 2)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:42<00:00,  7.04it/s, loss=0.0306, acc=99.1]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.16it/s]
Epoch 4/5 - Train Loss: 0.0306, Train Acc: 99.09%, Val Loss: 1.4721, Val Acc: 75.57%, Best Val Acc: 80.54% (Epoch 2)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:42<00:00,  7.05it/s, loss=0.0325, acc=99]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.09it/s]
Epoch 5/5 - Train Loss: 0.0325, Train Acc: 98.97%, Val Loss: 1.1590, Val Acc: 79.04%, Best Val Acc: 80.54% (Epoch 2)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.11it/s]

Fold 2 Evaluation:
Test Loss: 0.9881, Test Accuracy: 79.58%

================================================================================
Training on Fold 3
Train Folds: [1, 4, 5, 6, 7, 8, 9, 10]
Val Fold: [2]
Test Fold: [3]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/724 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:42<00:00,  7.04it/s, loss=0.253, acc=91.8]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:13<00:00,  6.94it/s]
Epoch 1/5 - Train Loss: 0.2533, Train Acc: 91.78%, Val Loss: 0.8910, Val Acc: 75.45%, Best Val Acc: 75.45% (Epoch 1)
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:42<00:00,  7.08it/s, loss=0.0547, acc=98.3]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.17it/s]
Epoch 2/5 - Train Loss: 0.0547, Train Acc: 98.30%, Val Loss: 1.5024, Val Acc: 73.21%, Best Val Acc: 75.45% (Epoch 1)
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:42<00:00,  7.05it/s, loss=0.0441, acc=98.6]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.00it/s]
Epoch 3/5 - Train Loss: 0.0441, Train Acc: 98.63%, Val Loss: 0.8300, Val Acc: 80.23%, Best Val Acc: 80.23% (Epoch 3)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:42<00:00,  7.07it/s, loss=0.0351, acc=99]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.21it/s]
Epoch 4/5 - Train Loss: 0.0351, Train Acc: 98.97%, Val Loss: 1.0251, Val Acc: 78.48%, Best Val Acc: 80.23% (Epoch 3)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:42<00:00,  7.07it/s, loss=0.0362, acc=98.9]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.15it/s]
Epoch 5/5 - Train Loss: 0.0362, Train Acc: 98.87%, Val Loss: 0.8328, Val Acc: 83.69%, Best Val Acc: 83.69% (Epoch 5)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:13<00:00,  6.99it/s]

Fold 3 Evaluation:
Test Loss: 1.3742, Test Accuracy: 77.25%

================================================================================
Training on Fold 4
Train Folds: [1, 2, 5, 6, 7, 8, 9, 10]
Val Fold: [3]
Test Fold: [4]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/723 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:42<00:00,  7.06it/s, loss=0.263, acc=91.4]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.11it/s]
Epoch 1/5 - Train Loss: 0.2631, Train Acc: 91.44%, Val Loss: 0.9192, Val Acc: 73.54%, Best Val Acc: 73.54% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:42<00:00,  7.06it/s, loss=0.0626, acc=98]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:13<00:00,  6.95it/s]
Epoch 2/5 - Train Loss: 0.0626, Train Acc: 98.02%, Val Loss: 1.5548, Val Acc: 73.13%, Best Val Acc: 73.54% (Epoch 1)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:42<00:00,  7.05it/s, loss=0.039, acc=98.8]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:13<00:00,  6.98it/s]
Epoch 3/5 - Train Loss: 0.0390, Train Acc: 98.80%, Val Loss: 1.0609, Val Acc: 76.87%, Best Val Acc: 76.87% (Epoch 3)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:42<00:00,  7.04it/s, loss=0.0387, acc=98.8]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:13<00:00,  6.99it/s]
Epoch 4/5 - Train Loss: 0.0387, Train Acc: 98.84%, Val Loss: 1.4731, Val Acc: 77.20%, Best Val Acc: 77.20% (Epoch 4)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:42<00:00,  7.06it/s, loss=0.0308, acc=99.1]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.08it/s]
Epoch 5/5 - Train Loss: 0.0308, Train Acc: 99.08%, Val Loss: 1.1741, Val Acc: 76.51%, Best Val Acc: 77.20% (Epoch 4)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  7.01it/s]

Fold 4 Evaluation:
Test Loss: 1.3741, Test Accuracy: 73.49%

================================================================================
Training on Fold 5
Train Folds: [1, 2, 3, 6, 7, 8, 9, 10]
Val Fold: [4]
Test Fold: [5]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/722 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:42<00:00,  7.05it/s, loss=0.264, acc=91.1]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.10it/s]
Epoch 1/5 - Train Loss: 0.2639, Train Acc: 91.12%, Val Loss: 0.8422, Val Acc: 78.37%, Best Val Acc: 78.37% (Epoch 1)
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:42<00:00,  7.05it/s, loss=0.0612, acc=98.1]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.26it/s]
Epoch 2/5 - Train Loss: 0.0612, Train Acc: 98.09%, Val Loss: 1.3039, Val Acc: 77.75%, Best Val Acc: 78.37% (Epoch 1)
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:42<00:00,  7.04it/s, loss=0.0428, acc=98.7]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.16it/s]
Epoch 3/5 - Train Loss: 0.0428, Train Acc: 98.67%, Val Loss: 1.5679, Val Acc: 73.90%, Best Val Acc: 78.37% (Epoch 1)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:42<00:00,  7.04it/s, loss=0.0333, acc=99]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.17it/s]
Epoch 4/5 - Train Loss: 0.0333, Train Acc: 98.99%, Val Loss: 1.1527, Val Acc: 81.61%, Best Val Acc: 81.61% (Epoch 4)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:42<00:00,  7.04it/s, loss=0.0334, acc=98.9]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  7.00it/s]
Epoch 5/5 - Train Loss: 0.0334, Train Acc: 98.91%, Val Loss: 1.6125, Val Acc: 78.03%, Best Val Acc: 81.61% (Epoch 4)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.25it/s]

Fold 5 Evaluation:
Test Loss: 1.0329, Test Accuracy: 79.02%

================================================================================
Training on Fold 6
Train Folds: [1, 2, 3, 4, 7, 8, 9, 10]
Val Fold: [5]
Test Fold: [6]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/723 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:42<00:00,  7.02it/s, loss=0.27, acc=91]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.73it/s]
Epoch 1/5 - Train Loss: 0.2698, Train Acc: 90.98%, Val Loss: 0.7978, Val Acc: 80.91%, Best Val Acc: 80.91% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:42<00:00,  7.03it/s, loss=0.0616, acc=98]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.91it/s]
Epoch 2/5 - Train Loss: 0.0616, Train Acc: 97.99%, Val Loss: 1.2491, Val Acc: 79.29%, Best Val Acc: 80.91% (Epoch 1)
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:42<00:00,  7.03it/s, loss=0.0431, acc=98.6]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.82it/s]
Epoch 3/5 - Train Loss: 0.0431, Train Acc: 98.62%, Val Loss: 1.4639, Val Acc: 72.96%, Best Val Acc: 80.91% (Epoch 1)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:43<00:00,  7.01it/s, loss=0.0396, acc=98.8]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.88it/s]
Epoch 4/5 - Train Loss: 0.0396, Train Acc: 98.82%, Val Loss: 1.4221, Val Acc: 79.62%, Best Val Acc: 80.91% (Epoch 1)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:44<00:00,  6.94it/s, loss=0.0273, acc=99.2]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.80it/s]
Epoch 5/5 - Train Loss: 0.0273, Train Acc: 99.18%, Val Loss: 1.1811, Val Acc: 77.25%, Best Val Acc: 80.91% (Epoch 1)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.91it/s]

Fold 6 Evaluation:
Test Loss: 1.0157, Test Accuracy: 74.36%

================================================================================
Training on Fold 7
Train Folds: [1, 2, 3, 4, 5, 8, 9, 10]
Val Fold: [6]
Test Fold: [7]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/722 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:55<00:00,  6.25it/s, loss=0.247, acc=92]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.76it/s]
Epoch 1/5 - Train Loss: 0.2467, Train Acc: 91.95%, Val Loss: 0.6432, Val Acc: 84.55%, Best Val Acc: 84.55% (Epoch 1)
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:43<00:00,  6.98it/s, loss=0.0546, acc=98.3]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.96it/s]
Epoch 2/5 - Train Loss: 0.0546, Train Acc: 98.32%, Val Loss: 0.7464, Val Acc: 81.07%, Best Val Acc: 84.55% (Epoch 1)
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:43<00:00,  6.98it/s, loss=0.0419, acc=98.7]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.89it/s]
Epoch 3/5 - Train Loss: 0.0419, Train Acc: 98.72%, Val Loss: 1.0545, Val Acc: 78.31%, Best Val Acc: 84.55% (Epoch 1)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:43<00:00,  6.96it/s, loss=0.0319, acc=99.1]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.95it/s]
Epoch 4/5 - Train Loss: 0.0319, Train Acc: 99.06%, Val Loss: 0.5665, Val Acc: 84.43%, Best Val Acc: 84.55% (Epoch 1)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:43<00:00,  6.98it/s, loss=0.0299, acc=99.1]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.73it/s]
Epoch 5/5 - Train Loss: 0.0299, Train Acc: 99.07%, Val Loss: 0.9128, Val Acc: 80.08%, Best Val Acc: 84.55% (Epoch 1)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.87it/s]

Fold 7 Evaluation:
Test Loss: 0.7425, Test Accuracy: 83.18%

================================================================================
Training on Fold 8
Train Folds: [1, 2, 3, 4, 5, 6, 9, 10]
Val Fold: [7]
Test Fold: [8]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/725 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:43<00:00,  7.00it/s, loss=0.244, acc=92]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.93it/s]
Epoch 1/5 - Train Loss: 0.2441, Train Acc: 91.96%, Val Loss: 0.6315, Val Acc: 81.91%, Best Val Acc: 81.91% (Epoch 1)
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:42<00:00,  7.04it/s, loss=0.0613, acc=98.1]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.15it/s]
Epoch 2/5 - Train Loss: 0.0613, Train Acc: 98.10%, Val Loss: 1.4525, Val Acc: 74.84%, Best Val Acc: 81.91% (Epoch 1)
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:43<00:00,  7.02it/s, loss=0.0425, acc=98.7]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.97it/s]
Epoch 3/5 - Train Loss: 0.0425, Train Acc: 98.67%, Val Loss: 1.0874, Val Acc: 76.86%, Best Val Acc: 81.91% (Epoch 1)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:42<00:00,  7.04it/s, loss=0.0371, acc=98.9]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.91it/s]
Epoch 4/5 - Train Loss: 0.0371, Train Acc: 98.87%, Val Loss: 0.9927, Val Acc: 80.69%, Best Val Acc: 81.91% (Epoch 1)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:42<00:00,  7.04it/s, loss=0.029, acc=99.1]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:13<00:00,  6.95it/s]
Epoch 5/5 - Train Loss: 0.0290, Train Acc: 99.10%, Val Loss: 0.8599, Val Acc: 81.62%, Best Val Acc: 81.91% (Epoch 1)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.03it/s]

Fold 8 Evaluation:
Test Loss: 0.8246, Test Accuracy: 78.97%

================================================================================
Training on Fold 9
Train Folds: [1, 2, 3, 4, 5, 6, 7, 10]
Val Fold: [8]
Test Fold: [9]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/728 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:43<00:00,  7.05it/s, loss=0.247, acc=91.9]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.19it/s]
Epoch 1/5 - Train Loss: 0.2466, Train Acc: 91.87%, Val Loss: 0.8757, Val Acc: 79.17%, Best Val Acc: 79.17% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:43<00:00,  7.06it/s, loss=0.0631, acc=98]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.14it/s]
Epoch 2/5 - Train Loss: 0.0631, Train Acc: 98.01%, Val Loss: 1.1713, Val Acc: 78.78%, Best Val Acc: 79.17% (Epoch 1)
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:43<00:00,  7.02it/s, loss=0.0372, acc=98.8]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:13<00:00,  6.84it/s]
Epoch 3/5 - Train Loss: 0.0372, Train Acc: 98.83%, Val Loss: 1.2179, Val Acc: 77.86%, Best Val Acc: 79.17% (Epoch 1)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:44<00:00,  6.97it/s, loss=0.0401, acc=98.8]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  6.96it/s]
Epoch 4/5 - Train Loss: 0.0401, Train Acc: 98.76%, Val Loss: 1.1557, Val Acc: 78.49%, Best Val Acc: 79.17% (Epoch 1)
Epoch 5: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:45<00:00,  6.87it/s, loss=0.031, acc=99]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  6.87it/s]
Epoch 5/5 - Train Loss: 0.0310, Train Acc: 99.03%, Val Loss: 1.1616, Val Acc: 78.49%, Best Val Acc: 79.17% (Epoch 1)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  6.94it/s]

Fold 9 Evaluation:
Test Loss: 0.6492, Test Accuracy: 84.69%

================================================================================
Training on Fold 10
Train Folds: [1, 2, 3, 4, 5, 6, 7, 8]
Val Fold: [9]
Test Fold: [10]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/727 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:44<00:00,  6.96it/s, loss=0.254, acc=91.5]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  6.92it/s]
Epoch 1/5 - Train Loss: 0.2536, Train Acc: 91.51%, Val Loss: 0.8776, Val Acc: 79.89%, Best Val Acc: 79.89% (Epoch 1)
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:43<00:00,  7.05it/s, loss=0.0584, acc=98.2]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:13<00:00,  6.64it/s]
Epoch 2/5 - Train Loss: 0.0584, Train Acc: 98.17%, Val Loss: 0.5823, Val Acc: 86.90%, Best Val Acc: 86.90% (Epoch 2)
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:43<00:00,  7.01it/s, loss=0.0427, acc=98.7]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  6.89it/s]
Epoch 3/5 - Train Loss: 0.0427, Train Acc: 98.71%, Val Loss: 0.5614, Val Acc: 88.67%, Best Val Acc: 88.67% (Epoch 3)
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:43<00:00,  7.03it/s, loss=0.0364, acc=98.9]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  6.99it/s]
Epoch 4/5 - Train Loss: 0.0364, Train Acc: 98.85%, Val Loss: 1.1257, Val Acc: 82.83%, Best Val Acc: 88.67% (Epoch 3)
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:43<00:00,  7.04it/s, loss=0.0275, acc=99.2]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  6.96it/s]
Epoch 5/5 - Train Loss: 0.0275, Train Acc: 99.16%, Val Loss: 0.7511, Val Acc: 84.06%, Best Val Acc: 88.67% (Epoch 3)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.12it/s]

Fold 10 Evaluation:
Test Loss: 0.7762, Test Accuracy: 79.75%

================================================================================
Summary of results for convnext
================================================================================
Average Test Accuracy: 79.14%
Individual Fold Test Accuracies: [81.05681229494043, 79.57988980716253, 77.2508591065292, 73.49418206707735, 79.0218132242672, 74.36073451175562, 83.1832852046883, 78.97154974377098, 84.6883230904302, 79.75170484350411]
Summary saved to output/convnext/summary.json
Total execution time: 6341.61 seconds (1.76 hours)