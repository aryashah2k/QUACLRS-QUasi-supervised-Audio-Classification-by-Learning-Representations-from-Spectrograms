(base) jupyter-st125462@puffer:~/ExtendedUrbansound$ python train_kfold.py --model_name alexnet --pretrained --batch_size 64 --epochs 5 --use_amp

================================================================================
Training on Fold 1
Train Folds: [2, 3, 4, 5, 6, 7, 8, 9]
Val Fold: [10]
Test Fold: [1]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/726 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:33<00:00,  7.73it/s, loss=0.782, acc=71.9]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.47it/s]
Epoch 1/5 - Train Loss: 0.7822, Train Acc: 71.92%, Val Loss: 0.8307, Val Acc: 74.51%, Best Val Acc: 74.51% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:32<00:00,  7.88it/s, loss=0.281, acc=91.2]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:11<00:00,  7.65it/s]
Epoch 2/5 - Train Loss: 0.2812, Train Acc: 91.15%, Val Loss: 1.2457, Val Acc: 69.23%, Best Val Acc: 74.51% (Epoch 1)
Epoch 3: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:31<00:00,  7.93it/s, loss=0.19, acc=94.4]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:11<00:00,  7.51it/s]
Epoch 3/5 - Train Loss: 0.1899, Train Acc: 94.41%, Val Loss: 1.4310, Val Acc: 77.09%, Best Val Acc: 77.09% (Epoch 3)
Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:30<00:00,  8.03it/s, loss=0.162, acc=95.3]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:12<00:00,  7.38it/s]
Epoch 4/5 - Train Loss: 0.1619, Train Acc: 95.34%, Val Loss: 1.1434, Val Acc: 77.95%, Best Val Acc: 77.95% (Epoch 4)
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 726/726 [01:30<00:00,  8.05it/s, loss=0.17, acc=95.4]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:11<00:00,  7.58it/s]
Epoch 5/5 - Train Loss: 0.1699, Train Acc: 95.44%, Val Loss: 1.4618, Val Acc: 76.48%, Best Val Acc: 77.95% (Epoch 4)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.56it/s]

Fold 1 Evaluation:
Test Loss: 1.9486, Test Accuracy: 80.63%

================================================================================
Training on Fold 2
Train Folds: [3, 4, 5, 6, 7, 8, 9, 10]
Val Fold: [1]
Test Fold: [2]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/724 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:29<00:00,  8.09it/s, loss=1.08, acc=59.9]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:11<00:00,  7.70it/s]
Epoch 1/5 - Train Loss: 1.0805, Train Acc: 59.87%, Val Loss: 0.7698, Val Acc: 81.80%, Best Val Acc: 81.80% (Epoch 1)
Epoch 2: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:30<00:00,  7.97it/s, loss=0.311, acc=90]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.39it/s]
Epoch 2/5 - Train Loss: 0.3113, Train Acc: 90.05%, Val Loss: 1.1035, Val Acc: 77.50%, Best Val Acc: 81.80% (Epoch 1)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:31<00:00,  7.91it/s, loss=0.221, acc=93.4]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.36it/s]
Epoch 3/5 - Train Loss: 0.2206, Train Acc: 93.38%, Val Loss: 0.9789, Val Acc: 76.20%, Best Val Acc: 81.80% (Epoch 1)
Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:28<00:00,  8.15it/s, loss=0.158, acc=95.4]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.39it/s]
Epoch 4/5 - Train Loss: 0.1581, Train Acc: 95.39%, Val Loss: 0.9625, Val Acc: 79.92%, Best Val Acc: 81.80% (Epoch 1)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:29<00:00,  8.07it/s, loss=0.138, acc=96.1]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.27it/s]
Epoch 5/5 - Train Loss: 0.1378, Train Acc: 96.09%, Val Loss: 1.6208, Val Acc: 81.51%, Best Val Acc: 81.80% (Epoch 1)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.57it/s]

Fold 2 Evaluation:
Test Loss: 0.9103, Test Accuracy: 73.71%

================================================================================
Training on Fold 3
Train Folds: [1, 4, 5, 6, 7, 8, 9, 10]
Val Fold: [2]
Test Fold: [3]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/724 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:29<00:00,  8.10it/s, loss=0.77, acc=73.5]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:11<00:00,  7.67it/s]
Epoch 1/5 - Train Loss: 0.7696, Train Acc: 73.47%, Val Loss: 0.9866, Val Acc: 72.40%, Best Val Acc: 72.40% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:31<00:00,  7.94it/s, loss=0.29, acc=91.2]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.53it/s]
Epoch 2/5 - Train Loss: 0.2901, Train Acc: 91.22%, Val Loss: 0.8926, Val Acc: 76.95%, Best Val Acc: 76.95% (Epoch 2)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:30<00:00,  8.04it/s, loss=0.196, acc=94.4]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.35it/s]
Epoch 3/5 - Train Loss: 0.1960, Train Acc: 94.39%, Val Loss: 1.1619, Val Acc: 71.50%, Best Val Acc: 76.95% (Epoch 2)
Epoch 4: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:30<00:00,  8.04it/s, loss=0.174, acc=95]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.42it/s]
Epoch 4/5 - Train Loss: 0.1741, Train Acc: 94.98%, Val Loss: 1.2734, Val Acc: 77.17%, Best Val Acc: 77.17% (Epoch 4)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 724/724 [01:30<00:00,  7.99it/s, loss=0.169, acc=95.6]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.58it/s]
Epoch 5/5 - Train Loss: 0.1694, Train Acc: 95.60%, Val Loss: 1.2017, Val Acc: 77.81%, Best Val Acc: 77.81% (Epoch 5)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.49it/s]

Fold 3 Evaluation:
Test Loss: 1.4070, Test Accuracy: 74.23%

================================================================================
Training on Fold 4
Train Folds: [1, 2, 5, 6, 7, 8, 9, 10]
Val Fold: [3]
Test Fold: [4]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/723 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:28<00:00,  8.20it/s, loss=0.921, acc=66.7]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:11<00:00,  7.69it/s]
Epoch 1/5 - Train Loss: 0.9207, Train Acc: 66.66%, Val Loss: 0.9410, Val Acc: 67.82%, Best Val Acc: 67.82% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:28<00:00,  8.20it/s, loss=0.331, acc=89.6]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:11<00:00,  7.67it/s]
Epoch 2/5 - Train Loss: 0.3309, Train Acc: 89.56%, Val Loss: 1.2627, Val Acc: 69.59%, Best Val Acc: 69.59% (Epoch 2)
Epoch 3:  46%|█████████████████████████████████████████████████████████▉                                                                   | 335/723 [00:42<00:41,  9.29it/s, loss=0.237, acc=92.7]
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:29<00:00,  8.10it/s, loss=0.217, acc=93.5]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:12<00:00,  7.36it/s]
Epoch 3/5 - Train Loss: 0.2170, Train Acc: 93.50%, Val Loss: 1.1601, Val Acc: 72.11%, Best Val Acc: 72.11% (Epoch 3)
Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:28<00:00,  8.18it/s, loss=0.196, acc=94.2]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:11<00:00,  7.76it/s]
Epoch 4/5 - Train Loss: 0.1962, Train Acc: 94.25%, Val Loss: 1.0267, Val Acc: 75.10%, Best Val Acc: 75.10% (Epoch 4)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:27<00:00,  8.22it/s, loss=0.192, acc=94.7]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 91/91 [00:11<00:00,  7.69it/s]
Epoch 5/5 - Train Loss: 0.1918, Train Acc: 94.74%, Val Loss: 1.3830, Val Acc: 71.96%, Best Val Acc: 75.10% (Epoch 4)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:11<00:00,  7.70it/s]

Fold 4 Evaluation:
Test Loss: 1.2923, Test Accuracy: 71.51%

================================================================================
Training on Fold 5
Train Folds: [1, 2, 3, 6, 7, 8, 9, 10]
Val Fold: [4]
Test Fold: [5]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/722 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:28<00:00,  8.15it/s, loss=1.07, acc=59.5]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.26it/s]
Epoch 1/5 - Train Loss: 1.0750, Train Acc: 59.49%, Val Loss: 1.2817, Val Acc: 65.71%, Best Val Acc: 65.71% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:31<00:00,  7.92it/s, loss=0.391, acc=87.1]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.24it/s]
Epoch 2/5 - Train Loss: 0.3911, Train Acc: 87.05%, Val Loss: 1.7661, Val Acc: 63.59%, Best Val Acc: 65.71% (Epoch 1)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:30<00:00,  8.02it/s, loss=0.249, acc=92.3]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.34it/s]
Epoch 3/5 - Train Loss: 0.2489, Train Acc: 92.30%, Val Loss: 1.9201, Val Acc: 65.11%, Best Val Acc: 65.71% (Epoch 1)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:30<00:00,  7.94it/s, loss=0.22, acc=93.4]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.27it/s]
Epoch 4/5 - Train Loss: 0.2205, Train Acc: 93.36%, Val Loss: 1.4303, Val Acc: 69.54%, Best Val Acc: 69.54% (Epoch 4)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:32<00:00,  7.76it/s, loss=0.163, acc=95.1]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.25it/s]
Epoch 5/5 - Train Loss: 0.1628, Train Acc: 95.14%, Val Loss: 1.9217, Val Acc: 68.55%, Best Val Acc: 69.54% (Epoch 4)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.41it/s]

Fold 5 Evaluation:
Test Loss: 1.7944, Test Accuracy: 68.81%

================================================================================
Training on Fold 6
Train Folds: [1, 2, 3, 4, 7, 8, 9, 10]
Val Fold: [5]
Test Fold: [6]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/723 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:30<00:00,  8.00it/s, loss=1.07, acc=61.6]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.53it/s]
Epoch 1/5 - Train Loss: 1.0725, Train Acc: 61.58%, Val Loss: 1.1400, Val Acc: 68.81%, Best Val Acc: 68.81% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:29<00:00,  8.06it/s, loss=0.352, acc=88.8]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.61it/s]
Epoch 2/5 - Train Loss: 0.3517, Train Acc: 88.83%, Val Loss: 1.5810, Val Acc: 70.43%, Best Val Acc: 70.43% (Epoch 2)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:29<00:00,  8.11it/s, loss=0.242, acc=92.6]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.66it/s]
Epoch 3/5 - Train Loss: 0.2416, Train Acc: 92.64%, Val Loss: 1.3856, Val Acc: 71.93%, Best Val Acc: 71.93% (Epoch 3)
Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:30<00:00,  8.02it/s, loss=0.175, acc=94.7]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.36it/s]
Epoch 4/5 - Train Loss: 0.1753, Train Acc: 94.65%, Val Loss: 2.4194, Val Acc: 68.90%, Best Val Acc: 71.93% (Epoch 3)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 723/723 [01:30<00:00,  7.96it/s, loss=0.166, acc=95.1]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.60it/s]
Epoch 5/5 - Train Loss: 0.1664, Train Acc: 95.15%, Val Loss: 1.4160, Val Acc: 69.56%, Best Val Acc: 71.93% (Epoch 3)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.56it/s]

Fold 6 Evaluation:
Test Loss: 0.8382, Test Accuracy: 77.52%

================================================================================
Training on Fold 7
Train Folds: [1, 2, 3, 4, 5, 8, 9, 10]
Val Fold: [6]
Test Fold: [7]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/722 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:31<00:00,  7.85it/s, loss=0.937, acc=65.8]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.24it/s]
Epoch 1/5 - Train Loss: 0.9372, Train Acc: 65.81%, Val Loss: 0.9243, Val Acc: 66.69%, Best Val Acc: 66.69% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:32<00:00,  7.78it/s, loss=0.325, acc=89.6]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.31it/s]
Epoch 2/5 - Train Loss: 0.3250, Train Acc: 89.57%, Val Loss: 0.8980, Val Acc: 74.65%, Best Val Acc: 74.65% (Epoch 2)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:31<00:00,  7.88it/s, loss=0.208, acc=93.9]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.45it/s]
Epoch 3/5 - Train Loss: 0.2082, Train Acc: 93.89%, Val Loss: 1.0514, Val Acc: 72.30%, Best Val Acc: 74.65% (Epoch 2)
Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:31<00:00,  7.88it/s, loss=0.164, acc=95.2]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.39it/s]
Epoch 4/5 - Train Loss: 0.1638, Train Acc: 95.21%, Val Loss: 1.9441, Val Acc: 70.72%, Best Val Acc: 74.65% (Epoch 2)
Epoch 5: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 722/722 [01:31<00:00,  7.88it/s, loss=0.179, acc=95]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.48it/s]
Epoch 5/5 - Train Loss: 0.1791, Train Acc: 94.99%, Val Loss: 1.1964, Val Acc: 73.31%, Best Val Acc: 74.65% (Epoch 2)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.34it/s]

Fold 7 Evaluation:
Test Loss: 1.0665, Test Accuracy: 72.01%

================================================================================
Training on Fold 8
Train Folds: [1, 2, 3, 4, 5, 6, 9, 10]
Val Fold: [7]
Test Fold: [8]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/725 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:31<00:00,  7.92it/s, loss=0.732, acc=74.5]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.34it/s]
Epoch 1/5 - Train Loss: 0.7320, Train Acc: 74.47%, Val Loss: 0.6893, Val Acc: 76.41%, Best Val Acc: 76.41% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:30<00:00,  8.01it/s, loss=0.253, acc=92.5]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.50it/s]
Epoch 2/5 - Train Loss: 0.2526, Train Acc: 92.51%, Val Loss: 1.0524, Val Acc: 73.30%, Best Val Acc: 76.41% (Epoch 1)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:30<00:00,  8.01it/s, loss=0.189, acc=94.7]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.44it/s]
Epoch 3/5 - Train Loss: 0.1888, Train Acc: 94.74%, Val Loss: 1.3630, Val Acc: 73.31%, Best Val Acc: 76.41% (Epoch 1)
Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:31<00:00,  7.96it/s, loss=0.166, acc=95.6]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:12<00:00,  7.65it/s]
Epoch 4/5 - Train Loss: 0.1661, Train Acc: 95.55%, Val Loss: 1.3708, Val Acc: 75.44%, Best Val Acc: 76.41% (Epoch 1)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 725/725 [01:30<00:00,  8.05it/s, loss=0.129, acc=96.5]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 92/92 [00:11<00:00,  7.67it/s]
Epoch 5/5 - Train Loss: 0.1292, Train Acc: 96.45%, Val Loss: 2.2186, Val Acc: 74.37%, Best Val Acc: 76.41% (Epoch 1)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.71it/s]

Fold 8 Evaluation:
Test Loss: 1.2415, Test Accuracy: 68.44%

================================================================================
Training on Fold 9
Train Folds: [1, 2, 3, 4, 5, 6, 7, 10]
Val Fold: [8]
Test Fold: [9]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/728 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:32<00:00,  7.88it/s, loss=0.914, acc=67.5]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.43it/s]
Epoch 1/5 - Train Loss: 0.9145, Train Acc: 67.55%, Val Loss: 1.1336, Val Acc: 67.27%, Best Val Acc: 67.27% (Epoch 1)
Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:32<00:00,  7.84it/s, loss=0.324, acc=89.7]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.54it/s]
Epoch 2/5 - Train Loss: 0.3239, Train Acc: 89.67%, Val Loss: 1.3196, Val Acc: 68.02%, Best Val Acc: 68.02% (Epoch 2)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:33<00:00,  7.83it/s, loss=0.219, acc=93.3]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.62it/s]
Epoch 3/5 - Train Loss: 0.2191, Train Acc: 93.25%, Val Loss: 1.4870, Val Acc: 70.10%, Best Val Acc: 70.10% (Epoch 3)
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:32<00:00,  7.89it/s, loss=0.19, acc=94.3]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.44it/s]
Epoch 4/5 - Train Loss: 0.1902, Train Acc: 94.34%, Val Loss: 1.7204, Val Acc: 67.08%, Best Val Acc: 70.10% (Epoch 3)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 728/728 [01:32<00:00,  7.89it/s, loss=0.169, acc=95.2]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:11<00:00,  7.54it/s]
Epoch 5/5 - Train Loss: 0.1689, Train Acc: 95.22%, Val Loss: 1.5334, Val Acc: 67.19%, Best Val Acc: 70.10% (Epoch 3)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.27it/s]

Fold 9 Evaluation:
Test Loss: 1.1134, Test Accuracy: 78.95%

================================================================================
Training on Fold 10
Train Folds: [1, 2, 3, 4, 5, 6, 7, 8]
Val Fold: [9]
Test Fold: [10]
================================================================================

/home/jupyter-st125462/.local/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:62: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(
/home/jupyter-st125462/ExtendedUrbansound/train_kfold.py:199: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler() if args.use_amp else None
Epoch 1:   0%|                                                                                                                                                             | 0/727 [00:00<?, ?it/s]/home/jupyter-st125462/ExtendedUrbansound/utils/training.py:44: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast():
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:30<00:00,  8.04it/s, loss=0.837, acc=70.6]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.13it/s]
Epoch 1/5 - Train Loss: 0.8370, Train Acc: 70.62%, Val Loss: 1.7024, Val Acc: 71.92%, Best Val Acc: 71.92% (Epoch 1)
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:29<00:00,  8.14it/s, loss=0.27, acc=91.6]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.38it/s]
Epoch 2/5 - Train Loss: 0.2697, Train Acc: 91.57%, Val Loss: 1.5551, Val Acc: 72.89%, Best Val Acc: 72.89% (Epoch 2)
Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:30<00:00,  8.02it/s, loss=0.196, acc=94.2]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.29it/s]
Epoch 3/5 - Train Loss: 0.1963, Train Acc: 94.18%, Val Loss: 1.1835, Val Acc: 76.45%, Best Val Acc: 76.45% (Epoch 3)
Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:30<00:00,  8.02it/s, loss=0.168, acc=95.2]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.23it/s]
Epoch 4/5 - Train Loss: 0.1677, Train Acc: 95.24%, Val Loss: 1.0889, Val Acc: 77.24%, Best Val Acc: 77.24% (Epoch 4)
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [01:30<00:00,  8.00it/s, loss=0.171, acc=95.4]
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 89/89 [00:12<00:00,  7.31it/s]
Epoch 5/5 - Train Loss: 0.1707, Train Acc: 95.40%, Val Loss: 1.7344, Val Acc: 77.12%, Best Val Acc: 77.24% (Epoch 4)
Validating: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 90/90 [00:11<00:00,  7.59it/s]

Fold 10 Evaluation:
Test Loss: 1.2807, Test Accuracy: 77.20%

================================================================================
Summary of results for alexnet
================================================================================
Average Test Accuracy: 74.30%
Individual Fold Test Accuracies: [80.62510792609221, 73.70867768595042, 74.22680412371135, 71.50924024640658, 68.81390593047034, 77.51844860133859, 72.00611516901648, 68.4396536490546, 78.94644424934152, 77.19881098094072]
Summary saved to output/alexnet/summary.json
Total execution time: 5799.66 seconds (1.61 hours)